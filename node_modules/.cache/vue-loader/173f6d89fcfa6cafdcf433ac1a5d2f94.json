{"remainingRequest":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\components\\common\\EnterpriseFilter.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\components\\common\\EnterpriseFilter.vue","mtime":1604460030009},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"EnterpriseFilter\",\n  props: {\n    conName: String,\n    templateName: String\n  },\n  data: () => ({\n    advanceFilterUnfold: false,\n    fields: [],\n    conditionAr:[],\n    removeShow:false,\n    bondCode:'',\n    industy:'',\n    organ:'',\n  }),\n  mounted() {\n\n  },\n  created() {\n    this.filterOptions = []\n    this.tooglePanel()\n  },\n  methods: {\n    compareDate(s1, s2){\n      if(s1.indexOf('-') > 0) {\n        s1 = s1.replace(/-/g,\"\\/\");\n      }else if(!/\\/|-/.test(s1)) {\n        s1 = s1.slice(0, 4) + '/' + s1.slice(4,6) + '/' + s1.slice(6,8);\n      }\n      if(s2.indexOf('-') > 0) {\n        s2 = s2.replace(/-/g,\"\\/\");\n      }else if(!/\\/|-/.test(s2)) {\n        s2 = s2.slice(0, 4) + '/' + s2.slice(4,6) + '/' + s2.slice(6,8);\n      }\n      return ((new Date(s1)) > (new Date(s2)));\n    },\n    loadFiledsAndInit() {\n      if (this.conName === undefined || this.templateName === undefined) {\n        return;\n      }\n      var svc = this.$http(this.conName, 'DV.AdvanceFilter_GetSettingByEnterPrise1', true);\n      svc.AddParam({\n        Name: 'TemplateName',\n        Value: this.templateName,\n        DBType: 'string'\n      });\n      svc.ExecTables().then((response) => {\n        if (!response || response.length < 1) {\n          return;\n        }\n        this.fields = JSON.parse(JSON.stringify(response[0]));\n      });\n    },\n    formatUIValueChange(field) {\n      var chosenTitles = [];\n      for (var i = 0, length = field.Options.length; i < length; i++) {\n        var option = field.Options[i];\n        if (option.Value) {\n          //var title = option.Text ? '{0} {1}'.Format(option.Text, option.Value) : option.Value;\n          chosenTitles.push(option.Value);\n          option.Chosen = true;\n        } else {\n          option.Chosen = false;\n        }\n      }\n      field.ChosenTitles = chosenTitles;\n      this.handleSearch()\n    },\n    tooglePanel() {\n      this.advanceFilterUnfold = !this.advanceFilterUnfold;\n      if (this.$parent.isOpenFilter !== undefined) {\n        this.$parent.isOpenFilter = this.advanceFilterUnfold;\n      }\n      if (this.advanceFilterUnfold &&\n        this.fields.length === 0 &&\n        this.filterOptions.length === 0) {\n\n        this.loadFiledsAndInit();\n      }\n    },\n    handleSearch() {\n      let ary = [];\n      if (this.bondCode.length >0){\n        ary.push(` TrustCode Like N'%{0}%'`.Format(this.bondCode))\n        this.conditionAr.FitterCode = 'TrustCode'\n        this.conditionAr.Fitter = 'like'\n        this.conditionAr.Value = this.bondCode\n      }\n      if (this.industy != '0' && this.industy.length >0){\n        ary.push(` TrustName = N'{0}'`.Format(this.industy))\n        this.conditionAr.FitterCode = 'TrustName'\n        this.conditionAr.Fitter = '='\n        this.conditionAr.Value = this.industy\n      }\n      if (this.organ != '0' && this.organ.length >0){\n        ary.push(` TrustNameShort = N'{0}'`.Format(this.organ))\n        this.conditionAr.FitterCode = 'TrustNameShort'\n        this.conditionAr.Fitter = '='\n        this.conditionAr.Value = this.organ\n      }\n      this.$emit('handleSearch', ary.join(' and '));\n      // // this.advanceFilterUnfold = false;\n      if (this.$parent.isOpenFilter !== undefined) {\n        this.$parent.isOpenFilter = false;\n      }\n      // this.$emit('handleSearchCon',this.conditionAr,this.removeShow)\n    },\n    // 刷新数据\n    refresh() {\n      this.loadFiledsAndInit();\n    }\n  },\n};\n\n",null]}