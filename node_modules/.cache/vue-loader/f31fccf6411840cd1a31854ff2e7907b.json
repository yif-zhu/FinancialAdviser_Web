{"remainingRequest":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\views\\product\\Cprcdrcrr.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\views\\product\\Cprcdrcrr.vue","mtime":1604281047458},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n  import ItemBox from '@/components/layout/ItemBox';\n  import HChart from '@/components/common/Highcharts';\n  export default {\n    components: {HChart, ItemBox},\n    data() {\n      return {\n        noData:false,\n        option2: null,\n        noData2:false,\n        tableData:[],\n        tableData2:[],\n        curveType:[{\n          name:'早偿率',\n          type:'CPR',\n          option:null,\n        },\n        {\n          name:'违约率',\n          type:'NewDefaultRate',\n          option:null,\n        },{\n          name:'回收率',\n          type:'CRR',\n          option:null,\n        },{\n          name:'累计违约率',\n          type:'CDR',\n          option:null,\n        }]\n      }\n    },\n    computed: {\n\t    TrustID() {\n\t      return this.$store.state.productInfo.trustId;\n\t    }\n\t  },\n    created() {\n      this.getChartData()\n      this.getOverdueData()\n    },\n    methods:{\n      getOverdueData() {\n        var svc = this.$http(\"PortfolioManagement\", \"DV.usp_GetArrearsDistributionCurve\");\n        svc.AddParam({ Name: 'TrustId', Value: this.TrustID, DBType: 'int' });\n        svc.ExecTable().then(res => {\n          if (res.length>0) {\n            let tableData2 = JSON.parse(JSON.stringify(res))\n            var data = {}\n            let xData = []\n            for (var i = 0; i < res.length; i++) {\n              xData.push(res[i].PaymentPeriodID+'期')\n              for(var key in res[i]) {\n                if (key == 'PCT_GT30' || key == 'PCT_GT60' || key == 'PCT_GT90') {\n                  res[i][key] = res[i][key]?Number(res[i][key].toFixed(4)):res[i][key];\n                  tableData2[i][key] = tableData2[i][key] || tableData2[i][key] == 0?tableData2[i][key].toFixed(4):tableData2[i][key]\n                  if (i == 0) {\n                    data[key] = []\n                  }\n                }\n                tableData2[i][key] = tableData2[i][key] == null?'ND':tableData2[i][key]\n              }\n              for(var key in data) {\n                data[key].push(res[i][key])\n              }\n            }\n            let serData = [];\n            this.tableData2 = tableData2;\n            for(var key in data) {\n              serData.push({\n                name:key=='PCT_GT30'?'逾期30+':key=='PCT_GT60'?'逾期60+':key=='PCT_GT90'?'逾期90+':'',\n                data:data[key]\n              })\n            }\n            console.log(serData)\n            this.option2 = this.optionFun(xData,serData)\n          }else{\n            this.noData2 = true\n          }\n        })\n      },\n      getChartData() {\n        var svc = this.$http(\"PortfolioManagement\", \"DV.usp_PDRateByTrustId\");\n        svc.AddParam({ Name: 'TrustId', Value: this.TrustID, DBType: 'int' });\n        svc.ExecTable().then(res => {\n          if (res.length>0) {\n            let tableData = JSON.parse(JSON.stringify(res))\n            var data = {}\n            let xData = []\n            for (var i = 0; i < res.length; i++) {\n              xData.push(res[i].PaymentPeriodID+'期')\n              \n                for(var key in res[i]) {\n                  if (key !== 'TrustID' && key !== 'AssetType' && key !== 'PaymentPeriodID') {\n                    res[i][key] = res[i][key]?Number(res[i][key].toFixed(4)):res[i][key]\n                    tableData[i][key] = tableData[i][key] || tableData[i][key] == 0?tableData[i][key].toFixed(4):tableData[i][key]\n                    if (i == 0) {\n                      data[key] = []\n                    }\n                  }\n                  tableData[i][key] = tableData[i][key] == null?'ND':tableData[i][key]\n                }\n              \n              for(var key in data) {\n                data[key].push(res[i][key])\n              }\n            }\n            this.tableData = tableData;\n            for(var key in data) {\n              console.log(key)\n              let obj = {}\n              for (var i = 0; i < this.curveType.length; i++) {\n               if (this.curveType[i].type == key) {\n                obj.name = this.curveType[i].name\n                obj.data = data[key]\n                if (key == 'NewDefaultRate') {\n                  let serData = []\n                  serData.push(obj)\n                  serData.push({\n                    name:'年化违约率',\n                    data:data.AnnualCDR\n                  })\n                  this.curveType[i].option = this.optionFun(xData,serData)\n                }else if(this.curveType[i].type == 'CPR') {\n                  let serData = []\n                  serData.push(obj)\n                  serData.push({\n                    name:'年化早偿率',\n                    data:data.AnnualCPR\n                  })\n                  this.curveType[i].option = this.optionFun(xData,serData)\n                }else if(this.curveType[i].type == 'CRR') {\n                  let serData = []\n                  serData.push(obj)\n                  serData.push({\n                    name:'累计回收率',\n                    data:data.CumCRR\n                  })\n                  this.curveType[i].option = this.optionFun(xData,serData)\n                }else{\n                  this.curveType[i].option = this.optionFun(xData,[obj])\n                }\n                \n               } \n              }\n            }\n          }else{\n          \tthis.noData = true\n          }\n\n        })\n      },\n      optionFun(xData,data) {\n        return {\n          chart: {\n            type: 'spline'\n          },\n          title: {\n            text: null\n          },\n          subtitle: {\n            text: null\n          },\n          xAxis: {\n            categories: xData,\n            crosshair: true\n          },\n          yAxis: {\n            title: {\n              text: '',\n            },\n            labels : { \n              format:'{value} %'\n            }\n          },\n          tooltip: {\n            // head + 每个 point + footer 拼接成完整的 table\n            headerFormat: '<span style=\"font-size:10px\">{point.key}</span><table>',\n            pointFormat: '<tr><td style=\"color:{series.color};padding:0\">{series.name}: </td>' +\n            '<td style=\"padding:0\"><b>{point.y} %</b></td></tr>',\n            footerFormat: '</table>',\n            shared: true,\n            useHTML: true\n          },\n          plotOptions: {\n            column: {\n              borderWidth: 0\n            }\n          },\n          series: data\n        };\n      }\n    }\n  }\n",{"version":3,"sources":["Cprcdrcrr.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cprcdrcrr.vue","sourceRoot":"src/views/product","sourcesContent":["<style scoped lang=\"scss\">\r\n.curveType{\r\n  display: flex;\r\n  .chart{\r\n    overflow: hidden;\r\n    flex:1;\r\n    border-right: 1px solid #f0f0f0;\r\n    padding-right: 10px;\r\n  }\r\n  .table{\r\n    flex:0 0 350px;\r\n    padding-left: 10px;\r\n  }\r\n}\r\n \r\n</style>\r\n\r\n<template>\r\n\t<div class=\"detailPage\">\r\n    <ItemBox title=\"逾期表现\">\r\n      <div class=\"curveType\">\r\n        <div class=\"chart\">\r\n          <HChart :options=\"option2\"></HChart>\r\n          <p v-show=\"noData2\" style=\"font-size: 12px;text-align: center;color: #999;\">暂无数据</p>\r\n        </div>\r\n        <div class=\"table\">\r\n          <el-table :data=\"tableData2\" height=\"350\">\r\n            <el-table-column prop=\"PaymentPeriodID\" label=\"期数\" width=\"60\"></el-table-column>\r\n            <el-table-column prop=\"PCT_GT30\" label=\"逾期30+(%)\" align=center></el-table-column>\r\n            <el-table-column prop=\"PCT_GT60\" label=\"逾期60+(%)\" align=center></el-table-column>\r\n            <el-table-column prop=\"PCT_GT90\" label=\"逾期90+(%)\" align=center></el-table-column>\r\n          </el-table>\r\n        </div>\r\n      </div>\r\n    </ItemBox>\r\n\t  <ItemBox title=\"DPR曲线\">\r\n      <div v-for=\"item in curveType\" class=\"curveType\">\r\n        <div class=\"chart\">\r\n          <HChart :options=\"item.option\"></HChart>\r\n          <p v-show=\"noData\" style=\"font-size: 12px;text-align: center;color: #999;\">暂无数据</p>\r\n        </div>\r\n        <div class=\"table\">\r\n          <el-table :data=\"tableData\" height=\"350\">\r\n            <el-table-column prop=\"PaymentPeriodID\" label=\"期数\" width=\"60\"></el-table-column>\r\n            <el-table-column :prop=\"item.type\" :label=\"item.name+'(%)'\" align=center></el-table-column>\r\n            <el-table-column prop=\"AnnualCPR\" label=\"年化早偿率(%)\" align=center v-if=\"item.type == 'CPR'\"></el-table-column>\r\n            <el-table-column prop=\"AnnualCDR\" label=\"年化违约率(%)\" align=center v-if=\"item.type == 'NewDefaultRate'\"></el-table-column>\r\n            <el-table-column prop=\"CumCRR\" label=\"累计回收率(%)\" align=center v-if=\"item.type == 'CRR'\"></el-table-column>\r\n          </el-table>\r\n        </div>\r\n      </div>\r\n\t  </ItemBox>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n  import ItemBox from '@/components/layout/ItemBox';\r\n  import HChart from '@/components/common/Highcharts';\r\n  export default {\r\n    components: {HChart, ItemBox},\r\n    data() {\r\n      return {\r\n        noData:false,\r\n        option2: null,\r\n        noData2:false,\r\n        tableData:[],\r\n        tableData2:[],\r\n        curveType:[{\r\n          name:'早偿率',\r\n          type:'CPR',\r\n          option:null,\r\n        },\r\n        {\r\n          name:'违约率',\r\n          type:'NewDefaultRate',\r\n          option:null,\r\n        },{\r\n          name:'回收率',\r\n          type:'CRR',\r\n          option:null,\r\n        },{\r\n          name:'累计违约率',\r\n          type:'CDR',\r\n          option:null,\r\n        }]\r\n      }\r\n    },\r\n    computed: {\r\n\t    TrustID() {\r\n\t      return this.$store.state.productInfo.trustId;\r\n\t    }\r\n\t  },\r\n    created() {\r\n      this.getChartData()\r\n      this.getOverdueData()\r\n    },\r\n    methods:{\r\n      getOverdueData() {\r\n        var svc = this.$http(\"PortfolioManagement\", \"DV.usp_GetArrearsDistributionCurve\");\r\n        svc.AddParam({ Name: 'TrustId', Value: this.TrustID, DBType: 'int' });\r\n        svc.ExecTable().then(res => {\r\n          if (res.length>0) {\r\n            let tableData2 = JSON.parse(JSON.stringify(res))\r\n            var data = {}\r\n            let xData = []\r\n            for (var i = 0; i < res.length; i++) {\r\n              xData.push(res[i].PaymentPeriodID+'期')\r\n              for(var key in res[i]) {\r\n                if (key == 'PCT_GT30' || key == 'PCT_GT60' || key == 'PCT_GT90') {\r\n                  res[i][key] = res[i][key]?Number(res[i][key].toFixed(4)):res[i][key];\r\n                  tableData2[i][key] = tableData2[i][key] || tableData2[i][key] == 0?tableData2[i][key].toFixed(4):tableData2[i][key]\r\n                  if (i == 0) {\r\n                    data[key] = []\r\n                  }\r\n                }\r\n                tableData2[i][key] = tableData2[i][key] == null?'ND':tableData2[i][key]\r\n              }\r\n              for(var key in data) {\r\n                data[key].push(res[i][key])\r\n              }\r\n            }\r\n            let serData = [];\r\n            this.tableData2 = tableData2;\r\n            for(var key in data) {\r\n              serData.push({\r\n                name:key=='PCT_GT30'?'逾期30+':key=='PCT_GT60'?'逾期60+':key=='PCT_GT90'?'逾期90+':'',\r\n                data:data[key]\r\n              })\r\n            }\r\n            console.log(serData)\r\n            this.option2 = this.optionFun(xData,serData)\r\n          }else{\r\n            this.noData2 = true\r\n          }\r\n        })\r\n      },\r\n      getChartData() {\r\n        var svc = this.$http(\"PortfolioManagement\", \"DV.usp_PDRateByTrustId\");\r\n        svc.AddParam({ Name: 'TrustId', Value: this.TrustID, DBType: 'int' });\r\n        svc.ExecTable().then(res => {\r\n          if (res.length>0) {\r\n            let tableData = JSON.parse(JSON.stringify(res))\r\n            var data = {}\r\n            let xData = []\r\n            for (var i = 0; i < res.length; i++) {\r\n              xData.push(res[i].PaymentPeriodID+'期')\r\n              \r\n                for(var key in res[i]) {\r\n                  if (key !== 'TrustID' && key !== 'AssetType' && key !== 'PaymentPeriodID') {\r\n                    res[i][key] = res[i][key]?Number(res[i][key].toFixed(4)):res[i][key]\r\n                    tableData[i][key] = tableData[i][key] || tableData[i][key] == 0?tableData[i][key].toFixed(4):tableData[i][key]\r\n                    if (i == 0) {\r\n                      data[key] = []\r\n                    }\r\n                  }\r\n                  tableData[i][key] = tableData[i][key] == null?'ND':tableData[i][key]\r\n                }\r\n              \r\n              for(var key in data) {\r\n                data[key].push(res[i][key])\r\n              }\r\n            }\r\n            this.tableData = tableData;\r\n            for(var key in data) {\r\n              console.log(key)\r\n              let obj = {}\r\n              for (var i = 0; i < this.curveType.length; i++) {\r\n               if (this.curveType[i].type == key) {\r\n                obj.name = this.curveType[i].name\r\n                obj.data = data[key]\r\n                if (key == 'NewDefaultRate') {\r\n                  let serData = []\r\n                  serData.push(obj)\r\n                  serData.push({\r\n                    name:'年化违约率',\r\n                    data:data.AnnualCDR\r\n                  })\r\n                  this.curveType[i].option = this.optionFun(xData,serData)\r\n                }else if(this.curveType[i].type == 'CPR') {\r\n                  let serData = []\r\n                  serData.push(obj)\r\n                  serData.push({\r\n                    name:'年化早偿率',\r\n                    data:data.AnnualCPR\r\n                  })\r\n                  this.curveType[i].option = this.optionFun(xData,serData)\r\n                }else if(this.curveType[i].type == 'CRR') {\r\n                  let serData = []\r\n                  serData.push(obj)\r\n                  serData.push({\r\n                    name:'累计回收率',\r\n                    data:data.CumCRR\r\n                  })\r\n                  this.curveType[i].option = this.optionFun(xData,serData)\r\n                }else{\r\n                  this.curveType[i].option = this.optionFun(xData,[obj])\r\n                }\r\n                \r\n               } \r\n              }\r\n            }\r\n          }else{\r\n          \tthis.noData = true\r\n          }\r\n\r\n        })\r\n      },\r\n      optionFun(xData,data) {\r\n        return {\r\n          chart: {\r\n            type: 'spline'\r\n          },\r\n          title: {\r\n            text: null\r\n          },\r\n          subtitle: {\r\n            text: null\r\n          },\r\n          xAxis: {\r\n            categories: xData,\r\n            crosshair: true\r\n          },\r\n          yAxis: {\r\n            title: {\r\n              text: '',\r\n            },\r\n            labels : { \r\n              format:'{value} %'\r\n            }\r\n          },\r\n          tooltip: {\r\n            // head + 每个 point + footer 拼接成完整的 table\r\n            headerFormat: '<span style=\"font-size:10px\">{point.key}</span><table>',\r\n            pointFormat: '<tr><td style=\"color:{series.color};padding:0\">{series.name}: </td>' +\r\n            '<td style=\"padding:0\"><b>{point.y} %</b></td></tr>',\r\n            footerFormat: '</table>',\r\n            shared: true,\r\n            useHTML: true\r\n          },\r\n          plotOptions: {\r\n            column: {\r\n              borderWidth: 0\r\n            }\r\n          },\r\n          series: data\r\n        };\r\n      }\r\n    }\r\n  }\r\n</script>\r\n"]}]}