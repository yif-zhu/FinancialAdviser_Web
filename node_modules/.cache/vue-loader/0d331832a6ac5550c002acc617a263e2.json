{"remainingRequest":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\components\\layout\\AppHeader.vue?vue&type=style&index=0&id=b82a324e&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\components\\layout\\AppHeader.vue","mtime":1604383717808},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n  .app-header{\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    display: flex;\n    justify-content: space-between;\n    flex-direction: column;\n    width: 100%;\n    height: 40px;\n    background: linear-gradient(to right , #2D3EAB, #0D1E8A 20%, #0D1E8A 70%, #3d4fc5);\n    background-color: #2D3EAB;\n    .inner{\n      padding: 0 20px;\n      .content{\n        display: flex;\n        height: 40px;\n        flex-direction: row;\n        align-items: center;\n        >div{\n          flex:1;\n        }\n        .logo{\n          flex:1;\n          font-size: 18px;\n          font-weight: bold;\n          color: #fff;\n          a{\n            color: #fff;\n            .dv-logo{\n              height: 26px\n            }\n          }\n        }\n        .menu{\n          ul{\n            text-align: right;\n            li{\n              display: inline-block;\n              font-size: 14px;\n              color: rgba(255,255,255,0.6);\n              margin-left: 40px;\n              vertical-align: middle;\n\n              &:first-child{\n                margin-left: 0;\n              }\n              &.message{\n                &.active{\n                  position: relative;\n                  &:before{\n                    display: inline-block;\n                    width: 5px;\n                    height: 5px;\n                    border-radius: 5px;\n                    background-color: red;\n                    content: '';\n                    position: absolute;\n                    top: -2px;right: -2px;\n                  }\n                }\n                i{\n                  cursor: pointer;\n                }\n              }\n              a{\n                color: rgba(255,255,255,0.6);\n                vertical-align: middle;\n                &.router-link-active{\n                  color: #fff;\n                }\n              }\n              &.userName{\n                span{\n                  vertical-align: middle;\n                }\n                img{\n                  width: 23px;\n                  height: 23px;\n                  vertical-align: middle;\n                  margin-right: 10px;\n                }\n              }\n            }\n          }\n\n          .setting{\n            color: rgba(255,255,255,0.6);\n            cursor: pointer;\n            &:hover{\n              color: #fff;\n            }\n          }\n        }\n\n      }\n\n    }\n  }\n.icon-guanzhu1{\n  color:rgb(247, 186, 42);\n  font-size:13px;\n  cursor: pointer;\n}\n.icon-guanzhu{\n  color: #c0c4cc;\n  font-size: 13px;\n  cursor: pointer;\n}\n.moreP{\n  font-size: 12px;\n  text-align: center;\n  line-height: 30px;\n  color: $--color-grey;\n  cursor: pointer;\n}\n.popoverUl{\n  a{\n    line-height: 30px;\n    font-size: 12px;\n    border-bottom: 1px solid #ddd;\n    color: $--color-grey;\n    display: inline-block;\n    overflow: hidden;\n    text-overflow:ellipsis;\n    white-space: nowrap;\n    width: 100%;\n    cursor: pointer;\n  }\n}\n.messageTab{\n  font-size: 12px;\n}\n/deep/ .el-tabs__item{\n  font-size: 12px;\n  height: 30px;\n  line-height: 30px;\n}\n",{"version":3,"sources":["AppHeader.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AppHeader.vue","sourceRoot":"src/components/layout","sourcesContent":["<style lang=\"scss\" scoped>\n  .app-header{\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    display: flex;\n    justify-content: space-between;\n    flex-direction: column;\n    width: 100%;\n    height: 40px;\n    background: linear-gradient(to right , #2D3EAB, #0D1E8A 20%, #0D1E8A 70%, #3d4fc5);\n    background-color: #2D3EAB;\n    .inner{\n      padding: 0 20px;\n      .content{\n        display: flex;\n        height: 40px;\n        flex-direction: row;\n        align-items: center;\n        >div{\n          flex:1;\n        }\n        .logo{\n          flex:1;\n          font-size: 18px;\n          font-weight: bold;\n          color: #fff;\n          a{\n            color: #fff;\n            .dv-logo{\n              height: 26px\n            }\n          }\n        }\n        .menu{\n          ul{\n            text-align: right;\n            li{\n              display: inline-block;\n              font-size: 14px;\n              color: rgba(255,255,255,0.6);\n              margin-left: 40px;\n              vertical-align: middle;\n\n              &:first-child{\n                margin-left: 0;\n              }\n              &.message{\n                &.active{\n                  position: relative;\n                  &:before{\n                    display: inline-block;\n                    width: 5px;\n                    height: 5px;\n                    border-radius: 5px;\n                    background-color: red;\n                    content: '';\n                    position: absolute;\n                    top: -2px;right: -2px;\n                  }\n                }\n                i{\n                  cursor: pointer;\n                }\n              }\n              a{\n                color: rgba(255,255,255,0.6);\n                vertical-align: middle;\n                &.router-link-active{\n                  color: #fff;\n                }\n              }\n              &.userName{\n                span{\n                  vertical-align: middle;\n                }\n                img{\n                  width: 23px;\n                  height: 23px;\n                  vertical-align: middle;\n                  margin-right: 10px;\n                }\n              }\n            }\n          }\n\n          .setting{\n            color: rgba(255,255,255,0.6);\n            cursor: pointer;\n            &:hover{\n              color: #fff;\n            }\n          }\n        }\n\n      }\n\n    }\n  }\n.icon-guanzhu1{\n  color:rgb(247, 186, 42);\n  font-size:13px;\n  cursor: pointer;\n}\n.icon-guanzhu{\n  color: #c0c4cc;\n  font-size: 13px;\n  cursor: pointer;\n}\n.moreP{\n  font-size: 12px;\n  text-align: center;\n  line-height: 30px;\n  color: $--color-grey;\n  cursor: pointer;\n}\n.popoverUl{\n  a{\n    line-height: 30px;\n    font-size: 12px;\n    border-bottom: 1px solid #ddd;\n    color: $--color-grey;\n    display: inline-block;\n    overflow: hidden;\n    text-overflow:ellipsis;\n    white-space: nowrap;\n    width: 100%;\n    cursor: pointer;\n  }\n}\n.messageTab{\n  font-size: 12px;\n}\n/deep/ .el-tabs__item{\n  font-size: 12px;\n  height: 30px;\n  line-height: 30px;\n}\n</style>\n<template>\n  <div class=\"app-header\">\n    <div class=\"inner\">\n      <div class=\"content\">\n        <div class=\"logo\">\n          <router-link to=\"/product/ProductList\">\n<!--            <img src=\"@/assets/images/dv.svg\" alt=\"\" class=\"dv-logo\">-->\n              财务分析系统\n          </router-link>\n        </div>\n<!--        <Search v-if=\"CUSTOMER === 'xiaomi'\"/>-->\n        <div class=\"menu\">\n          <ul class=\"app-menu\">\n<!--            <li class=\"menu-item\">-->\n<!--              <router-link to=\"/Overview\">-->\n<!--                <span>首页</span>-->\n<!--              </router-link>-->\n<!--            </li>-->\n            <li class=\"menu-item\">\n              <router-link to=\"/Product\">\n                <span>产品</span>\n              </router-link>\n            </li>\n\n            <li class=\"userName\">\n              <img :src=\"userImg\"/>\n              <el-dropdown @command=\"handleSetting\">\n                <span class=\"setting\">\n                设置<i class=\"el-icon-arrow-down el-icon--right\"></i>\n                </span>\n                <el-dropdown-menu slot=\"dropdown\" :visibleArrow=\"false\">\n                  <el-dropdown-item command=\"admin\">管理后台</el-dropdown-item>\n                  <el-dropdown-item command=\"modifyPassword\">修改密码</el-dropdown-item>\n                  <el-dropdown-item command=\"logout\">退出登录</el-dropdown-item>\n                </el-dropdown-menu>\n              </el-dropdown>\n            </li>\n          </ul>\n\n        </div>\n      </div>\n    </div>\n    <el-dialog title=\"修改密码\" width=\"430px\" :visible.sync=\"modifyPasswordDialog\" :lock-scroll=\"false\">\n      <el-form ref=\"passwordForm\" :model=\"passwordForm\" :rules=\"passwordRules\" key=\"modifyPassword\">\n        <el-form-item label=\"原密码\" prop=\"oldPassword\" :error=\"passwordErrors.oldPassword\">\n          <el-input type=\"password\" v-model=\"passwordForm.oldPassword\" auto-complete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"新密码\" prop=\"newPassword\" :error=\"passwordErrors.newPassword\">\n          <el-input type=\"password\" v-model=\"passwordForm.newPassword\" auto-complete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"确认密码\" prop=\"confirmPassword\" :error=\"passwordErrors.confirmPassword\">\n          <el-input type=\"password\" v-model=\"passwordForm.confirmPassword\" auto-complete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"handleModifyUserPassword\">确定</el-button>\n        </el-form-item>\n      </el-form>\n    </el-dialog>\n    <el-dialog title=\"提示信息\" width=\"1200px\" :visible.sync=\"showTips\" >\n          <el-table :showFilter=\"false\" :data=\"tableData\" ref=\"tipsTable\" style=\"min-height: 300px;\">\n              <el-table-column prop=\"TrustId\" label=\"编号\"></el-table-column>\n              <el-table-column prop=\"TrustCode\" label=\"产品代码\"></el-table-column>\n              <el-table-column prop=\"TrustName\" label=\"产品名称\"></el-table-column>\n              <el-table-column prop=\"ItemType\" label=\"类型\"></el-table-column>\n              <el-table-column prop=\"ItemCode\" label=\"ItemCode\"></el-table-column>\n              <el-table-column prop=\"ItemValue\" label=\"ItemValue\"></el-table-column>\n              <el-table-column prop=\"NewItemValue\" label=\"最新值\"> </el-table-column>\n              <el-table-column prop=\"LastItemValue\" label=\"上一天值\"></el-table-column>\n          </el-table>\n          <el-pagination\n            :page-sizes=\"[10,20,50,100]\"\n            :page-size=\"pagesize\"\n            :pager-count=\"5\"\n            layout=\"total, sizes, prev, pager, next, jumper\"\n            :total=\"total\"\n            background\n            @current-change=\"handleCurrentChange\"\n            :current-page=\"currentPage\"\n            @size-change=\"handleSizeChange\"\n            style=\"margin-top: 5px;\"\n          ></el-pagination>\n    </el-dialog>\n    <!-- 已关注产品 -->\n    <el-popover\n      placement=\"bottom\"\n      title=\"\"\n      width=\"220\"\n      v-model=\"showFollows\"\n      ref=\"popover\"\n      trigger=\"hover\">\n      <data-grid v-if=\"showFollows\" :show-header=\"false\" :showFilter=\"false\" conName=\"PortfolioManagement\" tableName=\"DV.view_Products\"\n        ref=\"refDataGrid\" isFixed :order=\"listOrder\" :filter=\"listFilter\" :needUserName=\"true\" :pageSize=\"5\" :showPager=\"false\">\n        <template slot=\"table-column\">\n          <el-table-column label=\"\" align=\"center\" width=\"35\">\n            <template slot-scope=\"{row}\">\n              <i class=\"iconfont\" :class=\"[row.IsConcerned ? 'icon-guanzhu1' :'icon-guanzhu']\" @click=\"focusFun($event,row.TrustId,row.IsConcerned)\" :title=\"row.IsConcerned ? '已关注':'未关注'\"></i>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"TrustNameShort\" label=\"\" :show-overflow-tooltip=\"true\">\n            <template slot-scope=\"{row}\">\n              <router-link :to=\"'/Product/Detail/' + row.TrustId\"\n                           class=\"link\"\n                           target=\"_blank\"\n                           :title=\"row.TrustNameShort\">\n                {{row.TrustNameShort}}\n              </router-link>\n            </template>\n          </el-table-column>\n        </template>\n      </data-grid>\n      <p class=\"moreP\" v-if=\"ConcernTrust.length>5\" @click=\"moreFocusFun\">\n        <span>查看更多</span>\n      </p>\n    </el-popover>\n    <!-- 消息通知 -->\n    <el-popover\n      placement=\"bottom-start\"\n      title=\"\"\n      width=\"200\"\n      ref=\"message\"\n      trigger=\"hover\">\n      <el-tabs v-model=\"activeRead\" class=\"messageTab\">\n        <el-tab-pane label=\"未读通知\" name=\"unread\">\n          <ul>\n            <li>未读111111111111</li>\n          </ul>\n        </el-tab-pane>\n        <el-tab-pane label=\"已读通知\" name=\"read\">\n          <ul>\n            <li>已读22222222222</li>\n          </ul>\n        </el-tab-pane>\n      </el-tabs>\n    </el-popover>\n\n  </div>\n</template>\n\n<script>\n  //import DynamicTab from '@/components/common/DynamicTab.vue';\n\n  import dataGrid from '@/components/common/DataGrid.vue';\n  import userImg from '@/assets/images/user.png'\n  // import Search from '@/components/search/Search';\n  import {mapState, mapMutations, mapMutions} from 'vuex';\n  import md5 from 'js-md5';\n  export default {\n    name: \"AppHeader\",\n    data() {\n      const validator = (rule, value, callback) => {\n        let test = /^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,20}$/;\n        if (value === '') {\n          callback(new Error('请输入密码'));\n        }else if (!(test.test(value))) {\n          callback(new Error('密码长度为8-20位，必须包括字母、数字'));\n        } else {\n          callback();\n        }\n      };\n      return {\n        active: '1',\n        userImg:userImg,\n        modifyPasswordDialog: false,\n        passwordForm: {\n          oldPassword:'',\n          newPassword:'',\n          confirmPassword: ''\n        },\n        passwordRules: {\n          newPassword: [\n            { validator, trigger: 'blur' }\n          ],\n          confirmPassword: [\n            { validator, trigger: 'blur' }\n          ],\n        },\n        passwordErrors: {\n          oldPassword: '',\n          newPassword: '',\n          confirmPassword: '',\n        },\n        activeRead:'unread',\n        listOrder: 'TrustId desc',\n        listFilter: 'IsConcerned=1',\n        showTips: false,\n        showColorsEgg: false,\n        versionName : 'Kookaburra',\n        total: 0,\n        currentPage: 1,\n        pagesize: 10,\n        filterCheckType: '',\n        tableData: [],\n        CUSTOMER: process.env.VUE_APP_CUSTOMER,\n        showFollows: false\n      }\n    },\n    components:{\n      dataGrid\n    },\n    computed: {\n      ...mapState('user',['userName', 'isRoot']),\n      ConcernTrust() {\n        return this.$store.state.productInfo.ConcernTrust\n      }\n    },\n    watch:{\n      ConcernTrust(v) {\n        if(this.$refs.refDataGrid) this.$refs.refDataGrid.refresh()\n      }\n    },\n    created() {\n      this.ConcernTrust_Get()\n    },\n    methods: {\n      // ...mapMutations('productInfo', ['setProductDetail','setConcernTrust'],['setLoginStatus']),\n      ...mapMutations(['setLoginStatus', 'productInfo/setProductDetail','productInfo/setConcernTrust']),\n      ConcernTrust_Get() {\n        var self = this;\n        var svc = this.$http('PortfolioManagement', 'DV.UserConcernTrust_Get');\n        svc.AddParam({\n          Name: 'UserName',\n          Value: self.userName,\n          DBType: 'string'\n        });\n        svc.ExecTable().then(res => {\n          // console.log(res)\n          // self.setConcernTrust(res)\n          self['productInfo/setConcernTrust'](res)\n        })\n      },\n      handleModifyUserPassword() {\n        const $form = this.$refs.passwordForm;\n        $form.validate((valid) => {\n          if(valid) {\n            const {\n              oldPassword,\n              newPassword,\n              confirmPassword\n            } = this.passwordForm;\n            if(oldPassword === newPassword) {\n              this.passwordErrors.newPassword = '请设置一个新的密码!';\n              return;\n            }\n            if(newPassword !== confirmPassword) {\n              this.passwordErrors.confirmPassword = '两次输入的密码不一致!';\n              return;\n            }\n\n            let svc = this.$http(\n              'UserManagement',\n              'QuickFrame.usp_ChangePasswordWithResult'\n            );\n            svc.AddParam({\n              Name: \"UserName\",\n              Value: this.userName,\n              DBType: \"string\"\n            });\n            svc.AddParam({\n              Name: \"OldPassword\",\n              Value: md5(oldPassword),\n              DBType: \"string\"\n            });\n            svc.AddParam({\n              Name: \"NewPassword\",\n              Value: md5(newPassword),\n              DBType: \"string\"\n            });\n            svc.ExecResult().then(res => {\n              if (res == 1) {\n                this.passwordErrors.oldPassword = '原密码不正确!';\n              }else{\n                this.$message.success('恭喜您，密码修改成功!');\n                this.modifyPasswordDialog = false;\n                $form.resetFields();\n                $form.clearValidate();\n              }\n            });\n          }\n        })\n      },\n      handleSetting(type) {\n        switch (type) {\n          case 'admin':\n            this.$router.push('/Admin');\n            break;\n          case 'logout':\n            this.$store.dispatch('user/handleUserLogout').then(()=>{\n              this.$router.push('/login');\n              this.setLoginStatus(false);\n            });\n            break;\n          case 'tips':\n            this.showTips = true\n             this.tips();\n             break;\n          case 'modifyPassword':\n            this.modifyPasswordDialog = true\n        }\n        //alert(type)\n      },\n    handleSizeChange(size) {\n      this.pagesize = size;\n      let currentPage=this.currentPage;\n      let pagesize= this.pagesize;\n      this.tableData = this.$allTableData.slice((currentPage-1)*pagesize,currentPage*pagesize);\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n      let currentPage=this.currentPage;\n      let pagesize= this.pagesize;\n      this.tableData = this.$allTableData.slice((currentPage-1)*pagesize,currentPage*pagesize);\n    },\n    tips(){\n      let self = this;\n      self.showTips = true;\n      let currentPage=this.currentPage;\n      let pagesize= this.pagesize;\n      let svc = self.$http(\"PortfolioManagement\", \"DV.usp_getCompareDataFromTrusteeHistory\", 0);\n      //svc.AddParam({ Name: \"type\", Value: 0, DBType: \"int\" });\n      svc.ExecTable().then(function(res) {\n        if(!res)return;\n        self.tableData = res.slice((currentPage-1)*pagesize,currentPage*pagesize);\n        self.$allTableData = res;\n        self.total = res.length;\n      })\n    },\n         moreFocusFun() {\n        this.$router.push({\n          path:'/ProductFocus/ProductList'\n        })\n      },\n      focusFun(el,TrustID,IsConcerned) {\n      var dataUrl = '',MStype=\"\",MStext=\"\"\n      if (IsConcerned) {\n        // el.target.className = 'iconfont icon-guanzhu'\n        dataUrl = 'DV.UserConcernTrust_Delete'\n        MStype=\"info\",MStext=\"已取消产品关注\"\n      }\n      var self = this;\n      var svc = this.$http('PortfolioManagement', dataUrl);\n      svc.AddParam({\n        Name: 'UserName',\n        Value: self.userName,\n        DBType: 'string'\n      });\n\n      svc.AddParam({\n        Name: 'TrustID',\n        Value: TrustID,\n        DBType: 'int'\n      });\n      svc.ExecTable().then(res => {\n        console.log(res)\n        if (res[0].Column1 == 1) {\n          self.$message({ type:MStype, message:MStext, })\n          self.$refs.refDataGrid.refresh()\n          self.ConcernTrust_Get()\n        }\n      })\n    },\n    }\n  }\n</script>\n"]}]}