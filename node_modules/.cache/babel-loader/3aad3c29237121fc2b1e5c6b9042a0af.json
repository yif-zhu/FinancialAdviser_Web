{"remainingRequest":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\views\\reportManage\\ReportList.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\views\\reportManage\\ReportList.vue","mtime":1604661597351},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport reportFilter from '@/components/common/ReportFilter.vue';\nimport dataGrid from '@/components/common/DataGrid.vue';\nimport FileSaver from 'file-saver';\nimport XLSX from 'xlsx';\nimport { BasePath } from '@/utils/config.js';\nimport { addClass, removeClass, hasClass } from '@/utils/dom.js';\nimport { mapState, mapMutations } from 'vuex';\nimport fsvc from \"@/api/FileService\";\nimport csvc from \"@/api/CommonService\";\nimport taskprocess from \"@/api/TaskProcess\";\nexport default {\n  components: {\n    dataGrid: dataGrid,\n    reportFilter: reportFilter\n  },\n  data: function data() {\n    return {\n      listOrder: 'ItemId asc,TrustStartDate asc',\n      listFilter: 'IsMarketProduct = 1',\n      searchS: true,\n      fields: [],\n      removeShow: false,\n      searchCon: false,\n      bondCode: '',\n      checkedData: [],\n      tableDataList: [],\n      // 为华泰客户环境\n      IS_HUATAI: process.env.VUE_APP_CUSTOMER && process.env.VUE_APP_CUSTOMER === 'huatai',\n      viewType: 'DV.view_Products',\n      reportUpload: false,\n      dialogUploadFileName: '',\n      progressSw: false,\n      progressText: '正在保存文件，请稍等',\n      percentage: 0\n    };\n  },\n  computed: {\n    userName: function userName() {\n      return this.$store.state.user.userName;\n    },\n    ConcernTrust: function ConcernTrust() {\n      return this.$store.state.productInfo.ConcernTrust;\n    }\n  },\n  methods: _objectSpread(_objectSpread({}, mapMutations('productInfo', ['setProductDetail', 'setConcernTrust'])), {}, {\n    searchSC: function searchSC() {\n      this.searchS = !this.searchS;\n    },\n    EditReport: function EditReport(TrustID) {\n      this.reportUpload = true;\n      this.TrustId = TrustID;\n    },\n    downloadReport: function downloadReport(TrustId) {\n      //下载报告\n      this.$message.success('下载成功');\n    },\n    deleteReport: function deleteReport(TrustID) {\n      //删除报告\n      var self = this;\n\n      if (confirm(\"确定要删除所选产品吗?\")) {\n        self.$message.success('删除成功');\n      }\n    },\n    dialogFileInputs: function dialogFileInputs(event) {\n      var file = event.target.files;\n\n      if (file.length == 1) {\n        this.dialogUploadFileName = file[0].name;\n      }\n    },\n    dialogUploadCilck: function dialogUploadCilck(id) {\n      $(\"#\" + id).click();\n    },\n    reportingFilesUpload: function reportingFilesUpload() {\n      var self = this;\n      var postData = $(\"#excelUploads\")[0].files;\n\n      if (postData.length < 1) {\n        self.$message.error('请选择上传的文件');\n        return;\n      }\n\n      self.reportUpload = false;\n      self.percentage = 0;\n      var postDataI = 0;\n      var nbprogress = 0;\n      var postDataName = postData[postDataI].name;\n\n      var progress = function progress(progressEvt) {\n        self.progressSw = true;\n        nbprogress = progressEvt.loaded / progressEvt.total;\n        self.percentage = parseInt((postDataI + nbprogress) / postData.length * 100);\n      };\n\n      var callback1 = function callback1(fpath) {\n        self.progressText = '';\n        var filePath = fpath.UploadResult;\n        filePath = filePath.substr(0, filePath.lastIndexOf('/') + 1);\n        var fileType = postDataName.substr(postDataName.lastIndexOf(\".\") + 1);\n        var svc = self.$http('PortfolioManagement', 'DV.TrustAssociatedDocs_Add');\n        svc.AddParam({\n          Name: \"TrustId\",\n          Value: self.TrustID,\n          DBType: \"int\"\n        });\n        svc.AddParam({\n          Name: \"FileCategory\",\n          Value: self.fileType,\n          DBType: \"string\"\n        });\n        svc.AddParam({\n          Name: \"FilePath\",\n          Value: filePath,\n          DBType: \"string\"\n        });\n        svc.AddParam({\n          Name: \"FileName\",\n          Value: postDataName,\n          DBType: \"string\"\n        });\n        svc.AddParam({\n          Name: \"FileType\",\n          Value: fileType,\n          DBType: \"string\"\n        });\n        svc.AddParam({\n          Name: \"UserName\",\n          Value: self.userName,\n          DBType: \"string\"\n        });\n        svc.ExecResult().then(function (res) {\n          res = parseInt(res);\n\n          if (isNaN(res)) {\n            self.$message.error('文件上传发生内部服务错误');\n            self.progressSw = false;\n          } else {\n            self.progressSw = true;\n            self.progressText = '已成功上传文件';\n            setTimeout(function () {\n              self.progressSw = false;\n              self.progressText = '';\n            }, 500);\n          }\n        });\n      };\n\n      fsvc.UploadOther(postData[postDataI], postDataName, folderName, 1)(progress, callback1);\n    },\n    row_key: function row_key(row) {\n      //console.log(row)\n      return this.viewType === 'DV.view_Products' ? row.TrustId : row.SNO;\n    },\n    doProductListFilter: function doProductListFilter(condition) {\n      console.log(condition);\n      this.listFilter = condition; // this.bondCode = bondCode;\n    },\n    handleSearchCon: function handleSearchCon(fields, removeShow) {\n      this.fields = fields;\n      this.removeShow = removeShow;\n      console.log(fields);\n    },\n    removeColdChosen: function removeColdChosen() {\n      this.$refs.advFilterR.bondCodeClear();\n    },\n    removeFieldChosen: function removeFieldChosen(fields) {\n      this.$refs.advFilterR.removeFieldChosen(fields);\n    },\n    doListSortChange: function doListSortChange(orderBy) {\n      this.listOrder = orderBy ? orderBy : 'TrustId desc';\n    },\n    //选中产品\n    selectRow: function selectRow(data) {\n      console.log(data);\n      this.checkedData = data;\n    },\n    listDataChanged: function listDataChanged(data) {\n      this.tableDataList = data;\n    }\n  }),\n  mounted: function mounted() {\n    this.$title();\n    this.listFilter = \"IsMarketProduct = 1\";\n  }\n};",{"version":3,"sources":["ReportList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"productList\" style=\"height:100%;display:flex;\">\n    <div class=\"searchBox\" v-show=\"searchS\">\n      <report-filter conName=\"QuickFinance\" templateName=\"ProductListFilter\"\n        v-on:handleSearch=\"doProductListFilter\" @handleSearchCon=\"handleSearchCon\" ref=\"advFilterR\">\n      </report-filter>\n    </div>\n    <div class=\"tableWrap transactionBox\" ref=\"tableWrap\">\n      <div class=\"searchBox-fold\" @click=\"searchSC\">\n        <i :class=\"searchS?'el-icon-caret-left':'el-icon-caret-right'\"></i>\n      </div>\n      <data-grid :showFilter=\"true\" id=\"export-table\" conName=\"QuickFinance\" proc-name=\"Report\" :tableName=\"viewType\"\n        ref=\"refDataGrid\" isFixed :order=\"listOrder\" @sortChange=\"doListSortChange\"\n        :filter=\"listFilter\" :needUserName=\"true\"  @select=\"selectRow\"  :multiSelection=\"true\" :row-key=\"row_key\" @listDataChanged=\"listDataChanged\" :key=\"viewType\">\n        <template slot=\"toolbar-filter\">\n          <div class=\"view-type\">财务分析报告列表</div>\n        </template>\n        <template slot=\"table-column\">\n          <el-table-column prop=\"TrustNameShort\" label=\"企业名称\" min-width=\"160\" :show-overflow-tooltip=\"true\">\n            <template slot-scope=\"{row}\">\n              <router-link :to=\"'Detail/' + row.TrustId\" class=\"link\" target=\"_blank\"\n                :title=\"row.TrustNameShort\">\n                {{row.TrustNameShort}}\n              </router-link>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"TrustName\" label=\"报告名称\" sortable=\"custom\" min-width=\"200\"\n            :show-overflow-tooltip=\"true\">\n          </el-table-column>\n          <el-table-column prop=\"TrustStartDate\" label=\"报告日期\" sortable=\"custom\" width=\"120\">\n          </el-table-column>\n          <el-table-column prop=\"MarketCategoryName\" label=\"所属经营机构\" sortable=\"custom\" width=\"120\">\n          </el-table-column>\n          <el-table-column prop=\"ProductSubject\" label=\"创建人\" min-width=\"130\">\n          </el-table-column>\n          <el-table-column label=\"操作\" min-width=\"150\":show-overflow-tooltip=\"true\" >\n            <template slot-scope=\"{row}\">\n              <el-button @click=\"EditReport(row)\" size=\"mini\" type=\"text\">编辑</el-button>\n              <el-button @click=\"downloadReport(row)\" size=\"mini\" type=\"text\">下载</el-button>\n              <el-button @click=\"deleteReport(row)\" size=\"mini\" class=\"red\" type=\"text\">删除</el-button>\n            </template>\n          </el-table-column>\n\n        </template>\n      </data-grid>\n    </div>\n    <!-- 上传文件 -->\n    <base-dialog :close-on-click-modal=\"false\" title=\"更新财务分析报告\" :visible.sync=\"reportUpload\" width=\"500px\" draggable>\n      <div style=\"margin:20px 0;\">\n        <el-form ref=\"form\" autocomplete=\"off\" label-width=\"100px\" v-if=\"reportUpload\">\n          <el-form-item label=\"报告上传\">\n            <div class=\"dialogfileUploadBox\" style=\"margin:0;text-align:left;\">\n              <input type=\"file\" id=\"excelUploads\" @change=\"dialogFileInputs($event)\" class=\"fileUploadInput\" key=\"01\"/>\n              <el-input class=\"el_fileUploadInput\" v-model=\"dialogUploadFileName\" key=\"02\">\n                <el-button class=\"el_fileUploadBtn\" slot=\"append\" @click=\"dialogUploadCilck('excelUploads')\">选择文件\n                </el-button>\n              </el-input>\n            </div>\n          </el-form-item>\n        </el-form>\n      </div>\n      <p style=\"text-align:center\">\n        <el-button @click=\"reportUpload = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"reportingFilesUpload()\" size=\"mini\">\n          确定上传\n        </el-button>\n      </p>\n    </base-dialog>\n    <!-- 进度条 -->\n    <div class=\"progressOut\" v-if=\"progressSw\">\n      <el-progress type=\"circle\" :percentage=\"percentage\" color=\"#8e71c7\" :width=\"90\"></el-progress>\n      <p style=\"color:#333;position: absolute;top: 50%;width: 100%;text-align: center;font-size: 13px;margin-top:50px;\">\n        {{progressText}}\n      </p>\n    </div>\n  </div>\n</template>\n\n<script>\n  import reportFilter from '@/components/common/ReportFilter.vue'\n  import dataGrid from '@/components/common/DataGrid.vue';\n  import FileSaver from 'file-saver';\n  import XLSX from 'xlsx';\n\timport { BasePath } from '@/utils/config.js';\n  import {\n    addClass,\n    removeClass,\n    hasClass\n  } from '@/utils/dom.js'\n  import {\n    mapState,\n    mapMutations\n  } from 'vuex';\n  import fsvc from \"@/api/FileService\";\n  import csvc from \"@/api/CommonService\";\n  import taskprocess from \"@/api/TaskProcess\";\n  export default {\n    components: {\n      dataGrid,\n      reportFilter\n    },\n    data() {\n      return {\n        listOrder: 'ItemId asc,TrustStartDate asc',\n        listFilter: 'IsMarketProduct = 1',\n        searchS: true,\n        fields: [],\n        removeShow: false,\n        searchCon: false,\n        bondCode:'',\n        checkedData:[],\n        tableDataList:[],\n        // 为华泰客户环境\n        IS_HUATAI: process.env.VUE_APP_CUSTOMER && process.env.VUE_APP_CUSTOMER === 'huatai',\n        viewType: 'DV.view_Products',\n        reportUpload:false,\n        dialogUploadFileName:'',\n        progressSw:false,\n        progressText: '正在保存文件，请稍等',\n        percentage: 0,\n      }\n    },\n    computed: {\n      userName() {\n        return this.$store.state.user.userName;\n      },\n      ConcernTrust() {\n        return this.$store.state.productInfo.ConcernTrust\n      }\n    },\n    methods: {\n      ...mapMutations('productInfo', ['setProductDetail', 'setConcernTrust']),\n      searchSC() {\n        this.searchS = !this.searchS\n      },\n      EditReport(TrustID){\n        this.reportUpload = true;\n        this.TrustId = TrustID;\n      },\n      downloadReport(TrustId){\n      //下载报告\n        this.$message.success('下载成功');\n      },\n      deleteReport(TrustID){\n      //删除报告\n        let self = this;\n        if (confirm(\"确定要删除所选产品吗?\")) {\n          self.$message.success('删除成功');\n        }\n      },\n      dialogFileInputs(event) {\n        var file = event.target.files;\n        if (file.length == 1) {\n          this.dialogUploadFileName = file[0].name;\n        }\n      },\n      dialogUploadCilck(id) {\n        $(\"#\" + id).click();\n      },\n      reportingFilesUpload() {\n        var self = this;\n        var postData = $(\"#excelUploads\")[0].files;\n        if (postData.length < 1) {\n          self.$message.error('请选择上传的文件');\n          return;\n        }\n\n        self.reportUpload = false;\n        self.percentage = 0\n        var postDataI = 0;\n        var nbprogress = 0;\n        var postDataName = postData[postDataI].name;\n        const progress = function (progressEvt) {\n          self.progressSw = true\n          nbprogress = progressEvt.loaded / progressEvt.total;\n          self.percentage = parseInt((postDataI + nbprogress) / (postData.length) * 100)\n\n        };\n        var callback1 = function (fpath) {\n          self.progressText = ''\n          let filePath = fpath.UploadResult;\n          filePath = filePath.substr(0,filePath.lastIndexOf('/')+1)\n          let fileType = postDataName.substr(postDataName.lastIndexOf(\".\") + 1);\n          var svc = self.$http('PortfolioManagement', 'DV.TrustAssociatedDocs_Add');\n          svc.AddParam({\n            Name: \"TrustId\",\n            Value: self.TrustID,\n            DBType: \"int\"\n          });\n          svc.AddParam({\n            Name: \"FileCategory\",\n            Value: self.fileType,\n            DBType: \"string\"\n          });\n          svc.AddParam({\n            Name: \"FilePath\",\n            Value: filePath,\n            DBType: \"string\"\n          });\n          svc.AddParam({\n            Name: \"FileName\",\n            Value: postDataName,\n            DBType: \"string\"\n          });\n          svc.AddParam({\n            Name: \"FileType\",\n            Value: fileType,\n            DBType: \"string\"\n          });\n          svc.AddParam({\n            Name: \"UserName\",\n            Value: self.userName,\n            DBType: \"string\"\n          });\n          svc.ExecResult().then(res => {\n            res = parseInt(res);\n            if (isNaN(res)) {\n              self.$message.error('文件上传发生内部服务错误');\n              self.progressSw = false\n            } else {\n                self.progressSw = true\n                self.progressText = '已成功上传文件'\n                setTimeout(() => {\n                  self.progressSw = false\n                  self.progressText = ''\n                }, 500)\n              }\n          });\n        }\n        fsvc.UploadOther(postData[postDataI], postDataName, folderName, 1)(progress, callback1)\n      },\n      row_key(row) {\n        //console.log(row)\n        return this.viewType === 'DV.view_Products' ? row.TrustId : row.SNO;\n      },\n\n      doProductListFilter(condition) {\n         console.log(condition)\n          this.listFilter = condition;\n          // this.bondCode = bondCode;\n      },\n      handleSearchCon(fields, removeShow) {\n        this.fields = fields\n        this.removeShow = removeShow\n        console.log(fields)\n      },\n      removeColdChosen() {\n        this.$refs.advFilterR.bondCodeClear()\n      },\n      removeFieldChosen(fields) {\n        this.$refs.advFilterR.removeFieldChosen(fields)\n      },\n      doListSortChange(orderBy) {\n        this.listOrder = orderBy ? orderBy : 'TrustId desc';\n      },\n      //选中产品\n    selectRow(data){\n      console.log(data)\n      this.checkedData = data\n    },\n\n    listDataChanged(data) {\n      this.tableDataList = data\n    },\n    },\n    mounted() {\n      this.$title();\n      this.listFilter = \"IsMarketProduct = 1\"\n    }\n  }\n\n</script>\n\n<style lang=\"scss\">\n  .productList {\n    background: #fff;\n    display: flex;\n    flex: 1;\n    min-height: 0;\n    height: 100%;\n    flex-direction: row;\n    overflow: hidden;\n\n    /deep/ .tool-bar {\n      height: 38px;\n\n      .tool-inner {\n        height: 38px;\n      }\n\n      .tool-right {\n        height: 38px;\n      }\n\n      .tool-left {\n        height: 38px;\n      }\n    }\n    .dialogfileUploadBox .el_fileUploadInput {\n      left: 0;\n      width: 300px;\n    }\n    .red {\n      color: red;\n\n      &:hover {\n        color: red;\n        opacity: .8;\n      }\n    }\n    .searchBox-fold{\n      width: 0px;\n      height: 50px;\n      transition: all .3s ease;\n      position: absolute;\n      top: 50%;\n      left: 0;\n      z-index: 9;\n      cursor: pointer;\n      border-left: 13px solid #3345b9;\n      border-bottom: 13px solid transparent;\n      border-top: 13px solid transparent;\n\n      i{\n        height: 20px;\n        position: absolute;\n        top: 5px;\n        left: -14px;\n        color: #fff;\n      }\n    }\n\n    .transactionBox {\n      height: 100%;\n      flex: 1;\n      width: 0;\n    }\n\n    .searchBox {\n      flex: 0 0 300px;\n      width: 0;\n      background-color: #f4f5fe;\n      padding-left: 15px;\n    }\n\n    .icon-guanzhu1 {\n      color: rgb(247, 186, 42);\n      font-size: 13px;\n      cursor: pointer;\n    }\n\n    .icon-guanzhu {\n      color: #c0c4cc;\n      font-size: 13px;\n      cursor: pointer;\n    }\n\n    .searchBox {\n      background-color: #f1f2fb;\n      width: 25%;\n      min-height: 0;\n      padding-left: 15px;\n    }\n\n    .el-checkbox-button--small .el-checkbox-button__inner {\n      border-radius: 2px !important;\n      margin-right: 10px;\n      background-color: #ddd;\n    }\n\n    .el-checkbox-button.is-checked .el-checkbox-button__inner {\n      background-color: $--app-theme-color;\n    }\n\n    .tableWrap {\n      position: relative;\n      width: 75%;\n      height: 100%;\n\n      >.data-grid {\n        display: flex;\n        flex-direction: column;\n        height: 100%;\n        .el-table--mini th {\n          padding: 1px 0;\n        }\n      }\n    }\n  }\n\n  .view-type{\n    line-height: 40px;\n    padding: 0 14px;\n\n    a{\n      color: #4D4D4D;\n      margin-right: 21px;\n      &:hover{\n        color: rgba(#4D4D4D, 0.8);\n      }\n      &.active{\n        color: $--color-primary;\n        font-weight: bold;\n      }\n    }\n  }\n\n  .clear-condition {\n    font-size: 12px;\n    text-align: center;\n    color: $--color-primary;\n    display: inline-block;\n    width: 100%;\n    cursor: pointer;\n  }\n\n  .chosen-fields {\n    display: inline-block;\n    margin-bottom: 10px;\n    margin-right: 10px;\n    background-color: #fff;\n    border: 1px solid $--color-grey-light;\n    color: $--color-primary;\n    border-radius: 3px;\n    font-size: 12px;\n    position: relative;\n    padding-right: 22px;\n    overflow: hidden;\n\n    &:hover {\n      border-color: $--color-primary;\n\n      .field-remove {\n        background-color: $--color-primary;\n        color: #fff;\n      }\n    }\n\n    .field-titles {\n      margin-right: 5px;\n      display: inline-block;\n      padding: 3px 0 3px 10px;\n\n      .title {\n        color: $--color-black;\n      }\n    }\n\n    .field-remove {\n      display: inline-block;\n      height: 100%;\n      cursor: pointer;\n      padding: 0 5px;\n      position: absolute;\n      top: 0;\n      right: -1px;\n      line-height: 26px;\n      width: 15px;\n      background-color: #f1f1f1;\n\n      i {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%)\n      }\n    }\n  }\n\n</style>\n"],"sourceRoot":"src/views/reportManage"}]}