{"remainingRequest":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\api\\CommonService.js","dependencies":[{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\api\\CommonService.js","mtime":1604664097076},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/*\n 封装后台服务请求\n 请求基于axios，文档https://github.com/axios/axios\n*/\nimport axios from 'axios';\nimport store from '@/store/index.js';\nimport ParamsBuilder from './ParamsBuilder.js';\nimport enchelper from '../utils/encryptHelper.js';\nimport { CommonServiceUrl } from '../utils/config.js';\n\nvar CommonService = /*#__PURE__*/function (_ParamsBuilder) {\n  _inherits(CommonService, _ParamsBuilder);\n\n  var _super = _createSuper(CommonService);\n\n  function CommonService(connName, spName) {\n    var _this;\n\n    var usingGet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n    _classCallCheck(this, CommonService);\n\n    _this = _super.call(this, connName, spName);\n    _this.usingGet = usingGet;\n    return _this;\n  }\n\n  _createClass(CommonService, [{\n    key: \"ExecTable\",\n    value: function ExecTable() {\n      return this.DataRequest('tbl');\n    }\n  }, {\n    key: \"ExecTables\",\n    value: function ExecTables() {\n      return this.DataRequest('set');\n    }\n  }, {\n    key: \"ExecResult\",\n    value: function ExecResult() {\n      return this.DataRequest('res');\n    }\n  }, {\n    key: \"DataRequest\",\n    value: function DataRequest(method) {\n      var serviceUrl = CommonServiceUrl;\n      var conn = this.ConnName,\n          dbargs = this.PrepareparamObj();\n      var reqArgs = {\n        \"SPName\": dbargs.SPName,\n        \"Param\": dbargs.SQLParams\n      };\n      var params = JSON.stringify(reqArgs);\n      return new Promise(function (resolve, reject) {\n        axios({\n          url: serviceUrl,\n          method: 'post',\n          data: {\n            \"ApiName\": \"GetDataSet\",\n            \"RequestParam\": enchelper.Encrypt(params)\n          }\n        }).then(function (res) {\n          var data = res.data;\n          if (data) data = method === 'res' ? data : typeof data === 'string' ? JSON.parse(data) : data;\n          var href = document.location.href;\n          var safeDomain = process.env.VUE_APP_Domain.replace(/^(http|https):\\/\\//, '');\n          var checkDomain = new RegExp(\"^(http|https):\\\\/\\\\/\" + safeDomain); // 仅对当前代理数据服务环境及本地开发环境显示请求信息\n\n          if (checkDomain.test(href) || process.env.NODE_ENV === 'development') {\n            console.groupCollapsed('%c 请求通过 ', 'background:green;color:#fff', '请求发起页面: ' + store.state.pageUrl, '请求接口:' + conn + '.' + dbargs.SPName);\n            console.log('%c 请求参数', 'color: #03A9F4; font-weight: bold', JSON.stringify(dbargs.SQLParams));\n            console.log('%c 响应结果', 'color: green; font-weight: bold', data);\n            console.groupEnd();\n          }\n\n          resolve(data);\n        }, function (err) {\n          // 上报出错接口\n          console.groupCollapsed('%c 请求失败 ', 'background:red;color:#fff', '请求发起页面: ' + store.state.pageUrl, '请求接口:' + conn + '.' + dbargs.SPName);\n          console.log('%c 请求参数', 'color: #red; font-weight: bold', JSON.stringify(dbargs.SQLParams));\n          console.groupEnd();\n          var res = err.response;\n\n          if (res.status) {\n            if (res.status === 401) {\n              store.commit('setLoginStatus', false);\n              store.commit('setRedirect', '/login');\n            }\n\n            if (res.status === 400) {\n              store.commit('sendMessage', {\n                message: '400 Invalid Parameters',\n                type: 'error'\n              });\n            }\n\n            if (res.status === 406) {\n              store.commit('sendMessage', {\n                message: '406 Request Not Authenticated',\n                type: 'error'\n              });\n            }\n\n            if (res.status === 416) {\n              store.commit('sendMessage', {\n                message: '416 Calling Undefinded Interface',\n                type: 'error'\n              });\n            }\n\n            if (res.status === 417) {\n              store.commit('sendMessage', {\n                message: '417 Unsupported Requests',\n                type: 'error'\n              });\n            }\n          }\n\n          reject(err);\n        }).catch(function (err) {\n          reject(err);\n        });\n      });\n    }\n  }]);\n\n  return CommonService;\n}(ParamsBuilder);\n\nexport { CommonService as default };",{"version":3,"sources":["C:/Users/yif_z/Desktop/DealViewer/src/api/CommonService.js"],"names":["axios","store","ParamsBuilder","enchelper","CommonServiceUrl","CommonService","connName","spName","usingGet","DataRequest","method","serviceUrl","conn","ConnName","dbargs","PrepareparamObj","reqArgs","SPName","SQLParams","params","JSON","stringify","Promise","resolve","reject","url","data","Encrypt","then","res","parse","href","document","location","safeDomain","process","env","VUE_APP_Domain","replace","checkDomain","RegExp","test","NODE_ENV","console","groupCollapsed","state","pageUrl","log","groupEnd","err","response","status","commit","message","type","catch"],"mappings":"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","sourcesContent":["/*\n 封装后台服务请求\n 请求基于axios，文档https://github.com/axios/axios\n*/\nimport axios from 'axios';\nimport store from '@/store/index.js';\nimport ParamsBuilder from './ParamsBuilder.js';\nimport enchelper from '../utils/encryptHelper.js';\nimport { CommonServiceUrl } from '../utils/config.js';\n\nexport default class CommonService extends ParamsBuilder{\n\n  constructor(connName, spName, usingGet = false) {\n    super(connName, spName);\n    this.usingGet = usingGet;\n  }\n\n  ExecTable() {\n    return this.DataRequest('tbl');\n  }\n\n  ExecTables() {\n    return this.DataRequest('set');\n  }\n\n  ExecResult() {\n    return this.DataRequest('res');\n  }\n\n  DataRequest(method) {\n    let serviceUrl = CommonServiceUrl;\n    let conn = this.ConnName,\n      dbargs = this.PrepareparamObj();\n\n    let reqArgs = {\n      \"SPName\":dbargs.SPName,\n      \"Param\":dbargs.SQLParams\n    }\n\n    let params = JSON.stringify(reqArgs);\n    return new Promise((resolve, reject) => {\n      axios({\n        url: serviceUrl,\n        method: 'post',\n        data: {\n          \"ApiName\": \"GetDataSet\",\n          \"RequestParam\": enchelper.Encrypt(params)\n        }\n      }).then(res => {\n        let data = res.data;\n        if(data) data = (method === 'res') ? data : typeof data === 'string' ? JSON.parse(data) : data;\n\n        let href = document.location.href;\n        let safeDomain = process.env.VUE_APP_Domain.replace(/^(http|https):\\/\\//, '');\n        let checkDomain = new RegExp(\"^(http|https):\\\\/\\\\/\"+safeDomain);\n        // 仅对当前代理数据服务环境及本地开发环境显示请求信息\n        if(checkDomain.test(href) || process.env.NODE_ENV === 'development') {\n          console.groupCollapsed('%c 请求通过 ',\n            'background:green;color:#fff',\n            '请求发起页面: ' +store.state.pageUrl,\n            '请求接口:' + conn + '.' +dbargs.SPName);\n          console.log('%c 请求参数', 'color: #03A9F4; font-weight: bold', JSON.stringify(dbargs.SQLParams));\n          console.log('%c 响应结果', 'color: green; font-weight: bold', data);\n          console.groupEnd();\n        }\n\n        resolve(data);\n      }, (err) => {\n        // 上报出错接口\n        console.groupCollapsed('%c 请求失败 ',\n          'background:red;color:#fff',\n          '请求发起页面: ' +store.state.pageUrl,\n          '请求接口:' + conn + '.' +dbargs.SPName);\n        console.log('%c 请求参数', 'color: #red; font-weight: bold', JSON.stringify(dbargs.SQLParams));\n        console.groupEnd();\n        let res = err.response;\n        if(res.status) {\n          if (res.status === 401) {\n            store.commit('setLoginStatus', false);\n            store.commit('setRedirect', '/login');\n          }\n          if (res.status === 400) {\n            store.commit('sendMessage', {\n              message: '400 Invalid Parameters',\n              type: 'error'\n            })\n          }\n          if (res.status === 406) {\n            store.commit('sendMessage', {\n              message: '406 Request Not Authenticated',\n              type: 'error'\n            })\n          }\n          if (res.status === 416) {\n            store.commit('sendMessage', {\n              message: '416 Calling Undefinded Interface',\n              type: 'error'\n            })\n          }\n          if (res.status === 417) {\n            store.commit('sendMessage', {\n              message: '417 Unsupported Requests',\n              type: 'error'\n            })\n          }\n        }\n        reject(err);\n      }).catch(err=>{\n        reject(err);\n      });\n    });\n  }\n}\n"]}]}