{"remainingRequest":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\views\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\views\\Login.vue","mtime":1604316944697},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport md5 from 'js-md5';\nimport cookie from '@/utils/cookie.js';\nimport keys from '@/utils/keys.js';\nimport { mapState, mapGetters, mapActions } from 'vuex';\nimport { BasePath } from '@/utils/config.js';\nvar captchaUrl = BasePath + 'Services/AuthenticationService.svc/Captcha';\nexport default {\n  name: \"Login\",\n  data: function data() {\n    var validator = function validator(rule, value, callback) {\n      var test = /^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,20}$/;\n\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else if (!test.test(value)) {\n        callback(new Error('密码长度为6-20位，必须包括字母、数字'));\n      } else {\n        callback();\n      }\n    };\n\n    var validatorC = function validatorC(rule, value, callback) {\n      if (value === '') {\n        callback(new Error('请输入确认密码'));\n      } else if (value != validator) {\n        callback(new Error('确认密码与密码不相符'));\n      } else {\n        callback();\n      }\n    };\n\n    var checkPhone = function checkPhone(rule, value, callback) {\n      var test = /^1[3456789]\\d{9}$/;\n\n      if (value === '') {\n        callback(new Error('手机号码'));\n      } else if (!test.test(value)) {\n        callback(new Error('请输入有效手机号'));\n      } else {\n        callback();\n      }\n    };\n\n    var checkEMail = function checkEMail(rule, value, callback) {\n      var test = /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/;\n\n      if (value === '') {\n        callback(new Error('请输入邮箱地址'));\n      } else if (!test.test(value)) {\n        callback(new Error('请输入有效邮箱地址'));\n      } else {\n        callback();\n      }\n    };\n\n    var checkUserName = function checkUserName(rule, value, callback) {\n      if (value === '') {\n        callback(new Error('请输入用户名'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      captcha: captchaUrl,\n      form: {\n        email: '',\n        password: '',\n        captcha: ''\n      },\n      isLoginT: true,\n      rules: {\n        email: [{\n          required: true,\n          message: '请输入用户名或邮箱',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }, {\n          type: 'string',\n          min: 6,\n          message: '密码不能少于6位',\n          trigger: 'blur'\n        }],\n        captcha: [{\n          required: true,\n          message: '请输入验证码',\n          trigger: 'blur'\n        }]\n      },\n      errorMsg: '',\n      captionErrorMsg: '',\n      submitStatus: false,\n      backgroundDiv: {\n        backgroundImage: 'url(' + require('@/assets/images/loginBg.jpg') + ')'\n      },\n      createUserForm: {\n        userName: '',\n        phone: '',\n        password: '',\n        passwordConfirm: '',\n        EMail: ''\n      },\n      createUserRules: {\n        userName: [{\n          validator: checkUserName,\n          trigger: 'blur'\n        }],\n        password: [{\n          validator: validator,\n          trigger: 'blur'\n        }],\n        passwordConfirm: [{\n          validatorC: validatorC,\n          trigger: 'blur'\n        }],\n        phone: [{\n          validator: checkPhone,\n          trigger: 'blur'\n        }],\n        EMail: [{\n          validator: checkEMail,\n          trigger: 'blur'\n        }]\n      },\n      createUserErrors: {\n        userName: '',\n        EMail: '',\n        password: '',\n        passwordConfirm: '',\n        phone: ''\n      },\n      CUSTOMER: process.env.VUE_APP_CUSTOMER,\n      showLogo: process.env.VUE_APP_ShowLogo,\n      isSimple: process.env.VUE_APP_IsSimple\n    };\n  },\n  created: function created() {\n    this.$title('登录');\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters(['isLogin'])), mapState(['siteTitle'])),\n  methods: _objectSpread(_objectSpread({}, mapActions('user', ['handleUserLogin'])), {}, {\n    dvRegister: function dvRegister() {\n      window.location.href = '/Community/#/register?appPath=' + encodeURIComponent('/DealViewer/#/login');\n    },\n    handleCreateUser: function handleCreateUser() {\n      var $form = this.$refs.createUserForm; // $form.validate((valid) => {\n      //   if(valid) {\n      //     const {userName, password, passwordConfirm, EMail,phone} = this.createUserForm;\n      //     let item = `<item>`;\n      //      item += `<UserName>${userName}</UserName>`;\n      //      item += `<Email>${EMail}</Email>`;\n      //      item += `<DisplayName>${displayName}</DisplayName>`;\n      //      item += `<LoweredUserName>${userName.toLocaleLowerCase()}</LoweredUserName>`;\n      //      item += `<Password>${md5(password)}</Password>`;\n      //      item += `<Password>${md5(password)}</Password>`;\n      //      item += `</item>`;\n      //     let svc = this.$http(\n      //       'UserManagement',\n      //       'QuickFrame.usp_AddUser'\n      //     );\n      //     svc.AddParam({\n      //       Name: \"item\",\n      //       Value: item,\n      //       DBType: \"string\"\n      //     });\n      //     svc.ExecResult().then(res=>{\n      //       if(res === 3) {\n      //         this.createUserErrors.userName = '账号已存在，换一个试试';\n      //       }else{\n      //         this.$message.success('账号创建成功!');\n      //         $form.resetFields();\n      //         $form.clearValidate();\n      //       }\n      //     });\n      //   }\n      // });\n    },\n    handleSubmit: function handleSubmit() {\n      var _this = this;\n\n      this.$refs.form.validate(function (valid) {\n        if (valid) {\n          _this.submitStatus = true;\n\n          if (_this.errorMsg !== '') {\n            _this.errorMsg = '';\n          }\n\n          if (_this.captionErrorMsg !== '') {\n            _this.captionErrorMsg = '';\n          } // let param = {\n          //   loginName: \"'\"+this.form.email.trim()+\"'\",\n          //   Password: \"'\"+this.form.password+\"'\"\n          //   //captcha: '1E6046FC-5C78-43D4-9409-3F62BB2979EC',\n          //   //captcha: this.isSimple == '0' ? this.form.captcha : '1E6046FC-5C78-43D4-9409-3F62BB2979EC'\n          // };\n\n\n          var param = {\n            username: _this.form.email.trim(),\n            password: md5(_this.form.password),\n            //captcha: '1E6046FC-5C78-43D4-9409-3F62BB2979EC',\n            captcha: _this.isSimple == '0' ? _this.form.captcha : '1E6046FC-5C78-43D4-9409-3F62BB2979EC'\n          };\n\n          _this.handleUserLogin(param).then(function (data) {\n            _this.submitStatus = false;\n\n            if (!data) {\n              _this.captionErrorMsg = '您输入的验证码不正确！';\n\n              _this.refreshCaptcha();\n\n              return;\n            }\n\n            var redirectURL = _this.$route.query.redirectURL;\n\n            if (redirectURL !== undefined) {\n              _this.$router.replace(redirectURL);\n            } else {\n              _this.$router.push(_this.isSimple == '0' ? \"/Product/ProductList\" : \"/quotation-analysis/index\");\n            }\n\n            cookie.set(keys.userInfo, JSON.stringify(data), {\n              path: '/'\n            });\n          }, function () {\n            _this.errorMsg = '您输入的密码和账户名不匹配！';\n            _this.captionErrorMsg = '';\n\n            _this.refreshCaptcha();\n\n            _this.submitStatus = false;\n          });\n        }\n      });\n    },\n    refreshCaptcha: function refreshCaptcha() {\n      this.captcha = captchaUrl + '?' + Math.random() * 100;\n    }\n  })\n};",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuLA,OAAA,GAAA,MAAA,QAAA;AACA,OAAA,MAAA,MAAA,mBAAA;AACA,OAAA,IAAA,MAAA,iBAAA;AACA,SACA,QADA,EAEA,UAFA,EAGA,UAHA,QAIA,MAJA;AAKA,SAAA,QAAA,QAAA,mBAAA;AACA,IAAA,UAAA,GAAA,QAAA,GAAA,4CAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,OADA;AAEA,EAAA,IAFA,kBAEA;AACA,QAAA,SAAA,GAAA,SAAA,SAAA,CAAA,IAAA,EAAA,KAAA,EAAA,QAAA,EAAA;AACA,UAAA,IAAA,GAAA,8CAAA;;AACA,UAAA,KAAA,KAAA,EAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,OAAA,CAAA,CAAA;AACA,OAFA,MAEA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,sBAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA,QAAA,QAAA;AACA;AACA,KATA;;AAUA,QAAA,UAAA,GAAA,SAAA,UAAA,CAAA,IAAA,EAAA,KAAA,EAAA,QAAA,EAAA;AACA,UAAA,KAAA,KAAA,EAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,SAAA,CAAA,CAAA;AACA,OAFA,MAEA,IAAA,KAAA,IAAA,SAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,YAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA,QAAA,QAAA;AACA;AACA,KARA;;AASA,QAAA,UAAA,GAAA,SAAA,UAAA,CAAA,IAAA,EAAA,KAAA,EAAA,QAAA,EAAA;AACA,UAAA,IAAA,GAAA,mBAAA;;AACA,UAAA,KAAA,KAAA,EAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,MAAA,CAAA,CAAA;AACA,OAFA,MAEA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,UAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA,QAAA,QAAA;AACA;AACA,KATA;;AAUA,QAAA,UAAA,GAAA,SAAA,UAAA,CAAA,IAAA,EAAA,KAAA,EAAA,QAAA,EAAA;AACA,UAAA,IAAA,GAAA,8FAAA;;AACA,UAAA,KAAA,KAAA,EAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,SAAA,CAAA,CAAA;AACA,OAFA,MAEA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,WAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA,QAAA,QAAA;AACA;AACA,KATA;;AAUA,QAAA,aAAA,GAAA,SAAA,aAAA,CAAA,IAAA,EAAA,KAAA,EAAA,QAAA,EAAA;AACA,UAAA,KAAA,KAAA,EAAA,EAAA;AACA,QAAA,QAAA,CAAA,IAAA,KAAA,CAAA,QAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA,QAAA,QAAA;AACA;AACA,KANA;;AAOA,WAAA;AACA,MAAA,OAAA,EAAA,UADA;AAEA,MAAA,IAAA,EAAA;AACA,QAAA,KAAA,EAAA,EADA;AAEA,QAAA,QAAA,EAAA,EAFA;AAGA,QAAA,OAAA,EAAA;AAHA,OAFA;AAOA,MAAA,QAAA,EAAA,IAPA;AAQA,MAAA,KAAA,EAAA;AACA,QAAA,KAAA,EAAA,CAAA;AACA,UAAA,QAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,WAFA;AAGA,UAAA,OAAA,EAAA;AAHA,SAAA,CADA;AAMA,QAAA,QAAA,EAAA,CAAA;AACA,UAAA,QAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,OAFA;AAGA,UAAA,OAAA,EAAA;AAHA,SAAA,EAIA;AACA,UAAA,IAAA,EAAA,QADA;AAEA,UAAA,GAAA,EAAA,CAFA;AAGA,UAAA,OAAA,EAAA,UAHA;AAIA,UAAA,OAAA,EAAA;AAJA,SAJA,CANA;AAgBA,QAAA,OAAA,EAAA,CAAA;AACA,UAAA,QAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,QAFA;AAGA,UAAA,OAAA,EAAA;AAHA,SAAA;AAhBA,OARA;AA8BA,MAAA,QAAA,EAAA,EA9BA;AA+BA,MAAA,eAAA,EAAA,EA/BA;AAgCA,MAAA,YAAA,EAAA,KAhCA;AAiCA,MAAA,aAAA,EAAA;AACA,QAAA,eAAA,EAAA,SAAA,OAAA,CAAA,6BAAA,CAAA,GAAA;AADA,OAjCA;AAoCA,MAAA,cAAA,EAAA;AACA,QAAA,QAAA,EAAA,EADA;AAEA,QAAA,KAAA,EAAA,EAFA;AAGA,QAAA,QAAA,EAAA,EAHA;AAIA,QAAA,eAAA,EAAA,EAJA;AAKA,QAAA,KAAA,EAAA;AALA,OApCA;AA2CA,MAAA,eAAA,EAAA;AACA,QAAA,QAAA,EAAA,CACA;AAAA,UAAA,SAAA,EAAA,aAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CADA;AAIA,QAAA,QAAA,EAAA,CACA;AAAA,UAAA,SAAA,EAAA,SAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CAJA;AAOA,QAAA,eAAA,EAAA,CACA;AAAA,UAAA,UAAA,EAAA,UAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CAPA;AAUA,QAAA,KAAA,EAAA,CACA;AAAA,UAAA,SAAA,EAAA,UAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CAVA;AAaA,QAAA,KAAA,EAAA,CACA;AAAA,UAAA,SAAA,EAAA,UAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA;AAbA,OA3CA;AA4DA,MAAA,gBAAA,EAAA;AACA,QAAA,QAAA,EAAA,EADA;AAEA,QAAA,KAAA,EAAA,EAFA;AAGA,QAAA,QAAA,EAAA,EAHA;AAIA,QAAA,eAAA,EAAA,EAJA;AAKA,QAAA,KAAA,EAAA;AALA,OA5DA;AAmEA,MAAA,QAAA,EAAA,OAAA,CAAA,GAAA,CAAA,gBAnEA;AAoEA,MAAA,QAAA,EAAA,OAAA,CAAA,GAAA,CAAA,gBApEA;AAqEA,MAAA,QAAA,EAAA,OAAA,CAAA,GAAA,CAAA;AArEA,KAAA;AAuEA,GAxHA;AAyHA,EAAA,OAzHA,qBAyHA;AACA,SAAA,MAAA,CAAA,IAAA;AACA,GA3HA;AA4HA,EAAA,QAAA,kCACA,UAAA,CAAA,CAAA,SAAA,CAAA,CADA,GAEA,QAAA,CAAA,CAAA,WAAA,CAAA,CAFA,CA5HA;AAgIA,EAAA,OAAA,kCACA,UAAA,CAAA,MAAA,EAAA,CAAA,iBAAA,CAAA,CADA;AAEA,IAAA,UAFA,wBAEA;AACA,MAAA,MAAA,CAAA,QAAA,CAAA,IAAA,GAAA,mCAAA,kBAAA,CAAA,qBAAA,CAAA;AACA,KAJA;AAKA,IAAA,gBALA,8BAKA;AACA,UAAA,KAAA,GAAA,KAAA,KAAA,CAAA,cAAA,CADA,CAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAvCA;AAwCA,IAAA,YAxCA,0BAwCA;AAAA;;AACA,WAAA,KAAA,CAAA,IAAA,CAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,UAAA,KAAA,CAAA,YAAA,GAAA,IAAA;;AACA,cAAA,KAAA,CAAA,QAAA,KAAA,EAAA,EAAA;AACA,YAAA,KAAA,CAAA,QAAA,GAAA,EAAA;AACA;;AACA,cAAA,KAAA,CAAA,eAAA,KAAA,EAAA,EAAA;AACA,YAAA,KAAA,CAAA,eAAA,GAAA,EAAA;AACA,WAPA,CAQA;AACA;AACA;AACA;AACA;AACA;;;AACA,cAAA,KAAA,GAAA;AACA,YAAA,QAAA,EAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,IAAA,EADA;AAEA,YAAA,QAAA,EAAA,GAAA,CAAA,KAAA,CAAA,IAAA,CAAA,QAAA,CAFA;AAGA;AACA,YAAA,OAAA,EAAA,KAAA,CAAA,QAAA,IAAA,GAAA,GAAA,KAAA,CAAA,IAAA,CAAA,OAAA,GAAA;AAJA,WAAA;;AAOA,UAAA,KAAA,CAAA,eAAA,CAAA,KAAA,EAAA,IAAA,CAAA,UAAA,IAAA,EAAA;AACA,YAAA,KAAA,CAAA,YAAA,GAAA,KAAA;;AACA,gBAAA,CAAA,IAAA,EAAA;AACA,cAAA,KAAA,CAAA,eAAA,GAAA,aAAA;;AACA,cAAA,KAAA,CAAA,cAAA;;AACA;AACA;;AACA,gBAAA,WAAA,GAAA,KAAA,CAAA,MAAA,CAAA,KAAA,CAAA,WAAA;;AAEA,gBAAA,WAAA,KAAA,SAAA,EAAA;AACA,cAAA,KAAA,CAAA,OAAA,CAAA,OAAA,CAAA,WAAA;AACA,aAFA,MAEA;AACA,cAAA,KAAA,CAAA,OAAA,CAAA,IAAA,CAAA,KAAA,CAAA,QAAA,IAAA,GAAA,GAAA,sBAAA,GAAA,2BAAA;AACA;;AACA,YAAA,MAAA,CAAA,GAAA,CAAA,IAAA,CAAA,QAAA,EAAA,IAAA,CAAA,SAAA,CAAA,IAAA,CAAA,EAAA;AACA,cAAA,IAAA,EAAA;AADA,aAAA;AAGA,WAjBA,EAiBA,YAAA;AACA,YAAA,KAAA,CAAA,QAAA,GAAA,gBAAA;AACA,YAAA,KAAA,CAAA,eAAA,GAAA,EAAA;;AACA,YAAA,KAAA,CAAA,cAAA;;AACA,YAAA,KAAA,CAAA,YAAA,GAAA,KAAA;AACA,WAtBA;AAuBA;AACA,OA9CA;AA+CA,KAxFA;AAyFA,IAAA,cAzFA,4BAyFA;AACA,WAAA,OAAA,GAAA,UAAA,GAAA,GAAA,GAAA,IAAA,CAAA,MAAA,KAAA,GAAA;AACA;AA3FA;AAhIA,CAAA","sourcesContent":["<style lang=\"scss\">\n  .login-page{\n    width: 100%;\n    height: 100vh;\n    overflow: auto;\n    padding-right: 15px;\n    background-repeat: no-repeat;\n    background-size: cover;\n    background-position: center;\n    &-content{\n      display: flex;\n      flex: 1;\n      align-items: center;\n      justify-content: center;\n      height: 100%;\n    }\n  }\n  .dv-logo{\n    height: 42px;\n  }\n  .cardWarp{\n    width: 700px;\n    display: flex;\n    box-shadow: 0 6px 13px rgba(50, 63, 148, 0.985);\n    border-radius: 8px;\n    position: relative;\n  }\n  .login-card{\n    width: 350px;\n    height: 370px;\n    background-color: #fff;\n    border-radius: 8px;\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n    position: relative;\n    perspective: 1500px;\n    .login-card-wrapper{\n      transform-style: preserve-3d;\n      transition: all 1s ease;\n      transform-origin: left;\n      background-color: #fff;\n      position: absolute;top: 0;\n      z-index: 9;\n      width: 100%;\n      height: 100%;\n      opacity: 1;\n      border-radius: 8px;\n    }\n    .transZ{\n      transform: rotateY(-180deg);\n      opacity: 0;\n    }\n    &-wrapper{\n      padding: 40px;\n    }\n    .el-form-item--small.el-form-item{\n      margin-bottom: 17px;\n    }\n  }\n  .rightName{\n    color: #fff;\n    padding-left: 30px;\n    border-radius: 0;\n    border-top-left-radius: 8px;\n    border-bottom-left-radius: 8px;\n    background: linear-gradient(-60deg,rgba(#593ce6,1) 24%,rgba(#5264D9,0.2)  );\n    h4{\n      font-size: 28px;\n      margin-top: 10px;\n    }\n    h2{\n      font-size: 28px;\n      margin-top: 120px;\n    }\n  }\n\n  .login-logo{\n    text-align: center;\n    line-height: 50px;\n    height: 50px;\n    color: $--color-primary;\n    font-weight: normal;\n    font-size: 20px;\n  }\n.registerDom {\n    width: 100%;\n    padding: 15px 25px!important;\n    background-color: #fff;\n    border-radius: 8px;\n    z-index: 1!important;\n    .el-form-item--small.el-form-item{\n      margin-bottom: 17px;\n    }\n    .el-form-item__label{\n      font-size: 12px;\n    }\n    .login-logo{\n      height: 10px;\n      line-height: 0;\n      font-size: 16px;\n    }\n  }\n  .login-button{\n    width: 100%;\n  }\n</style>\n\n<template>\n  <div class=\"login-page\" :style=\"backgroundDiv\">\n    <div class=\"login-page-content\">\n      <div class=\"cardWarp\" >\n      <div class=\"rightName login-card\">\n        <h2><img src=\"@/assets/images/dv_login.svg\" alt=\"\" class=\"dv-logo\"></h2>\n      </div>\n      <div class=\"login-card\">\n        <div class=\"login-card-wrapper\" :class=\"isLoginT?'':'transZ'\">\n          <div v-if=\"CUSTOMER === 'xiaomi' && showLogo == 1\" style=\"width:60px;height:60px;margin:0 auto;margin-bottom: 20px;\">\n            <img src=\"@/assets/images/mi.png\" alt=\"\">\n          </div>\n          <h1 class=\"login-logo\" v-else>登 录</h1>\n          <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" autocomplete=\"off\" >\n            <el-form-item prop=\"email\">\n              <el-input type=\"text\" id=\"Input_UserName\" prefix-icon=\"el-icon-message\" v-model=\"form.email\"\n                        auto-complete=\"email\" @keyup.enter.native=\"handleSubmit\" placeholder=\"用户名/邮箱\">\n              </el-input>\n            </el-form-item>\n            <el-form-item prop=\"password\" :error=\"errorMsg\">\n              <el-input type=\"password\" id=\"Input_Password\" prefix-icon=\"el-icon-lock\" v-model=\"form.password\"\n                        auto-complete=\"new-password\" @keyup.enter.native=\"handleSubmit\" placeholder=\"密码\">\n              </el-input>\n            </el-form-item>\n            <el-form-item v-if=\"isSimple == '0'\">\n              <el-col :span=\"12\">\n                <el-form-item prop=\"captcha\" style=\"margin-bottom: 0\" :error=\"captionErrorMsg\">\n                  <el-input v-model=\"form.captcha\" @keyup.enter.native=\"handleSubmit\" placeholder=\"验证码\"></el-input>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"12\">\n                <el-form-item style=\"margin-bottom: 0\">\n                  <img :src=\"captcha\" @click=\"refreshCaptcha\" style=\"cursor: pointer\"/>\n                </el-form-item>\n              </el-col>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" id=\"Button_Login\" class=\"login-button\" :disabled=\"submitStatus\" @click=\"handleSubmit\">\n                确 定\n              </el-button>\n              <p v-if=\"CUSTOMER === 'xiaomi' && isSimple == '0'\" style=\"text-align:center;font-size:12px;\"><span style=\"cursor: pointer;\" @click=\"dvRegister\">注册账号</span></p>\n            </el-form-item>\n          </el-form>\n        </div>\n<!--        <div class=\"registerDom login-card-wrapper\">\n          <h1 class=\"login-logo\">注 册</h1>\n          <el-form ref=\"createUserForm\" :model=\"createUserForm\" :rules=\"createUserRules\" key=\"createUser\" label-width=\"60px\">\n            <el-form-item label=\"用户名\" prop=\"userName\" :error=\"createUserErrors.userName\">\n              <el-input type=\"text\" v-model=\"createUserForm.userName\" auto-complete=\"off\" placeholder=\"用户名由字母、数字及下划线组成\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"手机号\" prop=\"phone\" :error=\"createUserErrors.userName\">\n              <el-input type=\"text\" v-model=\"createUserForm.userName\" auto-complete=\"off\" placeholder=\"请输入手机号码\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"邮箱\" prop=\"eMail\" :error=\"createUserErrors.EMail\">\n              <el-input type=\"text\" v-model=\"createUserForm.EMail\" auto-complete=\"off\" placeholder=\"请输入邮箱地址\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"密码\" prop=\"password\">\n              <el-input type=\"password\" v-model=\"createUserForm.password\" auto-complete=\"off\" placeholder=\"请输入不少于8位字符的密码\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"确认密码\" prop=\"passwordConfirm\">\n              <el-input type=\"password\" v-model=\"createUserForm.passwordConfirm\" auto-complete=\"off\" placeholder=\"请输入确认密码\"></el-input>\n            </el-form-item>\n            <p style=\"text-align:center;\">\n              <el-button type=\"primary\" @click=\"handleCreateUser\" class=\"login-button\">确 定</el-button>\n              <p style=\"text-align:center;font-size:12px;margin-top:7px;\"><span style=\"cursor: pointer;\" @click=\"isLoginT = true\">已有账号，去登录</span></p>\n            </p>\n          </el-form>\n        </div> -->\n      </div>\n      </div>\n\n    </div>\n  </div>\n</template>\n\n<script>\n  import md5 from 'js-md5';\n  import cookie from '@/utils/cookie.js';\n  import keys from '@/utils/keys.js';\n  import {\n    mapState,\n    mapGetters,\n    mapActions\n  } from 'vuex';\n  import { BasePath } from '@/utils/config.js';\n  const captchaUrl = BasePath + 'Services/AuthenticationService.svc/Captcha';\n  export default {\n    name: \"Login\",\n    data() {\n      const validator = (rule, value, callback) => {\n        let test = /^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,20}$/;\n        if (value === '') {\n          callback(new Error('请输入密码'));\n        }else if (!(test.test(value))) {\n          callback(new Error('密码长度为6-20位，必须包括字母、数字'));\n        } else {\n          callback();\n        }\n      };\n      const validatorC = (rule, value, callback) => {\n        if (value === '') {\n          callback(new Error('请输入确认密码'));\n        }else if (value != validator) {\n          callback(new Error('确认密码与密码不相符'));\n        } else {\n          callback();\n        }\n      };\n    const checkPhone = (rule, value, callback) => {\n      let test = /^1[3456789]\\d{9}$/;\n      if(value === '') {\n        callback(new Error('手机号码'));\n      }else if(!test.test(value)){\n        callback(new Error('请输入有效手机号'));\n      }else{\n        callback();\n      }\n    };\n    const checkEMail = (rule, value, callback) => {\n      let test = /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/;\n      if(value === '') {\n        callback(new Error('请输入邮箱地址'));\n      }else if(!test.test(value)){\n        callback(new Error('请输入有效邮箱地址'));\n      }else{\n        callback();\n      }\n    };\n    const checkUserName = (rule, value, callback) => {\n      if(value === '') {\n        callback(new Error('请输入用户名'));\n      }else{\n        callback();\n      }\n    };\n      return {\n        captcha: captchaUrl,\n        form: {\n          email: '',\n          password: '',\n          captcha: ''\n        },\n        isLoginT:true,\n        rules: {\n          email: [{\n            required: true,\n            message: '请输入用户名或邮箱',\n            trigger: 'blur'\n          }],\n          password: [{\n            required: true,\n            message: '请输入密码',\n            trigger: 'blur'\n          },{\n            type: 'string',\n            min: 6,\n            message: '密码不能少于6位',\n            trigger: 'blur'\n          }],\n          captcha: [{\n            required: true,\n            message: '请输入验证码',\n            trigger: 'blur'\n          }]\n        },\n        errorMsg: '',\n        captionErrorMsg: '',\n        submitStatus: false,\n        backgroundDiv: {\n            backgroundImage: 'url(' + require('@/assets/images/loginBg.jpg') + ')'\n        },\n        createUserForm: {\n          userName: '',\n          phone:'',\n          password: '',\n          passwordConfirm: '',\n          EMail:''\n        },\n        createUserRules: {\n        userName: [\n          { validator: checkUserName, trigger: 'blur' }\n        ],\n        password: [\n          { validator, trigger: 'blur' }\n        ],\n        passwordConfirm: [\n          { validatorC, trigger: 'blur' }\n        ],\n        phone: [\n          { validator: checkPhone, trigger: 'blur' }\n        ],\n        EMail: [\n          { validator: checkEMail, trigger: 'blur' }\n        ],\n      },\n      createUserErrors: {\n        userName: '',\n        EMail:'',\n        password:'',\n        passwordConfirm:'',\n        phone:''\n      },\n      CUSTOMER: process.env.VUE_APP_CUSTOMER,\n      showLogo: process.env.VUE_APP_ShowLogo,\n      isSimple: process.env.VUE_APP_IsSimple\n      };\n    },\n    created() {\n      this.$title('登录');\n    },\n    computed: {\n      ...mapGetters(['isLogin']),\n      ...mapState(['siteTitle'])\n    },\n    methods: {\n      ...mapActions('user', ['handleUserLogin']),\n      dvRegister() {\n        window.location.href = '/Community/#/register?appPath='+ encodeURIComponent('/DealViewer/#/login');\n      },\n      handleCreateUser() {\n        const $form = this.$refs.createUserForm;\n        // $form.validate((valid) => {\n        //   if(valid) {\n        //     const {userName, password, passwordConfirm, EMail,phone} = this.createUserForm;\n\n        //     let item = `<item>`;\n        //      item += `<UserName>${userName}</UserName>`;\n        //      item += `<Email>${EMail}</Email>`;\n        //      item += `<DisplayName>${displayName}</DisplayName>`;\n        //      item += `<LoweredUserName>${userName.toLocaleLowerCase()}</LoweredUserName>`;\n        //      item += `<Password>${md5(password)}</Password>`;\n        //      item += `<Password>${md5(password)}</Password>`;\n        //      item += `</item>`;\n        //     let svc = this.$http(\n        //       'UserManagement',\n        //       'QuickFrame.usp_AddUser'\n        //     );\n        //     svc.AddParam({\n        //       Name: \"item\",\n        //       Value: item,\n        //       DBType: \"string\"\n        //     });\n        //     svc.ExecResult().then(res=>{\n        //       if(res === 3) {\n        //         this.createUserErrors.userName = '账号已存在，换一个试试';\n        //       }else{\n        //         this.$message.success('账号创建成功!');\n        //         $form.resetFields();\n        //         $form.clearValidate();\n        //       }\n        //     });\n        //   }\n        // });\n      },\n      handleSubmit() {\n        this.$refs.form.validate((valid) => {\n          if (valid) {\n            this.submitStatus = true;\n            if (this.errorMsg !== '') {\n              this.errorMsg = '';\n            }\n            if (this.captionErrorMsg !== '') {\n              this.captionErrorMsg = '';\n            }\n            // let param = {\n            //   loginName: \"'\"+this.form.email.trim()+\"'\",\n            //   Password: \"'\"+this.form.password+\"'\"\n            //   //captcha: '1E6046FC-5C78-43D4-9409-3F62BB2979EC',\n            //   //captcha: this.isSimple == '0' ? this.form.captcha : '1E6046FC-5C78-43D4-9409-3F62BB2979EC'\n            // };\n            let param = {\n              username: this.form.email.trim(),\n              password: md5(this.form.password),\n              //captcha: '1E6046FC-5C78-43D4-9409-3F62BB2979EC',\n              captcha: this.isSimple == '0' ? this.form.captcha : '1E6046FC-5C78-43D4-9409-3F62BB2979EC'\n\n            };\n            this.handleUserLogin(param).then((data) => {\n              this.submitStatus = false;\n              if(!data) {\n                this.captionErrorMsg = '您输入的验证码不正确！';\n                this.refreshCaptcha();\n                return;\n              }\n              let redirectURL = this.$route.query.redirectURL;\n\n              if (redirectURL !== undefined) {\n                this.$router.replace(redirectURL);\n              } else {\n                this.$router.push(this.isSimple == '0' ? \"/Product/ProductList\" : \"/quotation-analysis/index\");\n              }\n              cookie.set(keys.userInfo, JSON.stringify(data), {\n                path: '/'\n              });\n            }, () => {\n              this.errorMsg = '您输入的密码和账户名不匹配！';\n              this.captionErrorMsg = '';\n              this.refreshCaptcha();\n              this.submitStatus = false;\n            });\n          }\n        });\n      },\n      refreshCaptcha() {\n        this.captcha = captchaUrl + '?' +(Math.random() * 100)\n      }\n    },\n  };\n\n</script>\n"],"sourceRoot":"src/views"}]}