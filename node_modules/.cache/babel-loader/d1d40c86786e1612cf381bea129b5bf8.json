{"remainingRequest":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\views\\product\\Cprcdrcrr.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\src\\views\\product\\Cprcdrcrr.vue","mtime":1604281047458},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yif_z\\Desktop\\DealViewer\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport ItemBox from '@/components/layout/ItemBox';\nimport HChart from '@/components/common/Highcharts';\nexport default {\n  components: {\n    HChart: HChart,\n    ItemBox: ItemBox\n  },\n  data: function data() {\n    return {\n      noData: false,\n      option2: null,\n      noData2: false,\n      tableData: [],\n      tableData2: [],\n      curveType: [{\n        name: '早偿率',\n        type: 'CPR',\n        option: null\n      }, {\n        name: '违约率',\n        type: 'NewDefaultRate',\n        option: null\n      }, {\n        name: '回收率',\n        type: 'CRR',\n        option: null\n      }, {\n        name: '累计违约率',\n        type: 'CDR',\n        option: null\n      }]\n    };\n  },\n  computed: {\n    TrustID: function TrustID() {\n      return this.$store.state.productInfo.trustId;\n    }\n  },\n  created: function created() {\n    this.getChartData();\n    this.getOverdueData();\n  },\n  methods: {\n    getOverdueData: function getOverdueData() {\n      var _this = this;\n\n      var svc = this.$http(\"PortfolioManagement\", \"DV.usp_GetArrearsDistributionCurve\");\n      svc.AddParam({\n        Name: 'TrustId',\n        Value: this.TrustID,\n        DBType: 'int'\n      });\n      svc.ExecTable().then(function (res) {\n        if (res.length > 0) {\n          var tableData2 = JSON.parse(JSON.stringify(res));\n          var data = {};\n          var xData = [];\n\n          for (var i = 0; i < res.length; i++) {\n            xData.push(res[i].PaymentPeriodID + '期');\n\n            for (var key in res[i]) {\n              if (key == 'PCT_GT30' || key == 'PCT_GT60' || key == 'PCT_GT90') {\n                res[i][key] = res[i][key] ? Number(res[i][key].toFixed(4)) : res[i][key];\n                tableData2[i][key] = tableData2[i][key] || tableData2[i][key] == 0 ? tableData2[i][key].toFixed(4) : tableData2[i][key];\n\n                if (i == 0) {\n                  data[key] = [];\n                }\n              }\n\n              tableData2[i][key] = tableData2[i][key] == null ? 'ND' : tableData2[i][key];\n            }\n\n            for (var key in data) {\n              data[key].push(res[i][key]);\n            }\n          }\n\n          var serData = [];\n          _this.tableData2 = tableData2;\n\n          for (var key in data) {\n            serData.push({\n              name: key == 'PCT_GT30' ? '逾期30+' : key == 'PCT_GT60' ? '逾期60+' : key == 'PCT_GT90' ? '逾期90+' : '',\n              data: data[key]\n            });\n          }\n\n          console.log(serData);\n          _this.option2 = _this.optionFun(xData, serData);\n        } else {\n          _this.noData2 = true;\n        }\n      });\n    },\n    getChartData: function getChartData() {\n      var _this2 = this;\n\n      var svc = this.$http(\"PortfolioManagement\", \"DV.usp_PDRateByTrustId\");\n      svc.AddParam({\n        Name: 'TrustId',\n        Value: this.TrustID,\n        DBType: 'int'\n      });\n      svc.ExecTable().then(function (res) {\n        if (res.length > 0) {\n          var tableData = JSON.parse(JSON.stringify(res));\n          var data = {};\n          var xData = [];\n\n          for (var i = 0; i < res.length; i++) {\n            xData.push(res[i].PaymentPeriodID + '期');\n\n            for (var key in res[i]) {\n              if (key !== 'TrustID' && key !== 'AssetType' && key !== 'PaymentPeriodID') {\n                res[i][key] = res[i][key] ? Number(res[i][key].toFixed(4)) : res[i][key];\n                tableData[i][key] = tableData[i][key] || tableData[i][key] == 0 ? tableData[i][key].toFixed(4) : tableData[i][key];\n\n                if (i == 0) {\n                  data[key] = [];\n                }\n              }\n\n              tableData[i][key] = tableData[i][key] == null ? 'ND' : tableData[i][key];\n            }\n\n            for (var key in data) {\n              data[key].push(res[i][key]);\n            }\n          }\n\n          _this2.tableData = tableData;\n\n          for (var key in data) {\n            console.log(key);\n            var obj = {};\n\n            for (var i = 0; i < _this2.curveType.length; i++) {\n              if (_this2.curveType[i].type == key) {\n                obj.name = _this2.curveType[i].name;\n                obj.data = data[key];\n\n                if (key == 'NewDefaultRate') {\n                  var serData = [];\n                  serData.push(obj);\n                  serData.push({\n                    name: '年化违约率',\n                    data: data.AnnualCDR\n                  });\n                  _this2.curveType[i].option = _this2.optionFun(xData, serData);\n                } else if (_this2.curveType[i].type == 'CPR') {\n                  var _serData = [];\n\n                  _serData.push(obj);\n\n                  _serData.push({\n                    name: '年化早偿率',\n                    data: data.AnnualCPR\n                  });\n\n                  _this2.curveType[i].option = _this2.optionFun(xData, _serData);\n                } else if (_this2.curveType[i].type == 'CRR') {\n                  var _serData2 = [];\n\n                  _serData2.push(obj);\n\n                  _serData2.push({\n                    name: '累计回收率',\n                    data: data.CumCRR\n                  });\n\n                  _this2.curveType[i].option = _this2.optionFun(xData, _serData2);\n                } else {\n                  _this2.curveType[i].option = _this2.optionFun(xData, [obj]);\n                }\n              }\n            }\n          }\n        } else {\n          _this2.noData = true;\n        }\n      });\n    },\n    optionFun: function optionFun(xData, data) {\n      return {\n        chart: {\n          type: 'spline'\n        },\n        title: {\n          text: null\n        },\n        subtitle: {\n          text: null\n        },\n        xAxis: {\n          categories: xData,\n          crosshair: true\n        },\n        yAxis: {\n          title: {\n            text: ''\n          },\n          labels: {\n            format: '{value} %'\n          }\n        },\n        tooltip: {\n          // head + 每个 point + footer 拼接成完整的 table\n          headerFormat: '<span style=\"font-size:10px\">{point.key}</span><table>',\n          pointFormat: '<tr><td style=\"color:{series.color};padding:0\">{series.name}: </td>' + '<td style=\"padding:0\"><b>{point.y} %</b></td></tr>',\n          footerFormat: '</table>',\n          shared: true,\n          useHTML: true\n        },\n        plotOptions: {\n          column: {\n            borderWidth: 0\n          }\n        },\n        series: data\n      };\n    }\n  }\n};",{"version":3,"sources":["Cprcdrcrr.vue"],"names":[],"mappings":"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","sourcesContent":["<style scoped lang=\"scss\">\r\n.curveType{\r\n  display: flex;\r\n  .chart{\r\n    overflow: hidden;\r\n    flex:1;\r\n    border-right: 1px solid #f0f0f0;\r\n    padding-right: 10px;\r\n  }\r\n  .table{\r\n    flex:0 0 350px;\r\n    padding-left: 10px;\r\n  }\r\n}\r\n \r\n</style>\r\n\r\n<template>\r\n\t<div class=\"detailPage\">\r\n    <ItemBox title=\"逾期表现\">\r\n      <div class=\"curveType\">\r\n        <div class=\"chart\">\r\n          <HChart :options=\"option2\"></HChart>\r\n          <p v-show=\"noData2\" style=\"font-size: 12px;text-align: center;color: #999;\">暂无数据</p>\r\n        </div>\r\n        <div class=\"table\">\r\n          <el-table :data=\"tableData2\" height=\"350\">\r\n            <el-table-column prop=\"PaymentPeriodID\" label=\"期数\" width=\"60\"></el-table-column>\r\n            <el-table-column prop=\"PCT_GT30\" label=\"逾期30+(%)\" align=center></el-table-column>\r\n            <el-table-column prop=\"PCT_GT60\" label=\"逾期60+(%)\" align=center></el-table-column>\r\n            <el-table-column prop=\"PCT_GT90\" label=\"逾期90+(%)\" align=center></el-table-column>\r\n          </el-table>\r\n        </div>\r\n      </div>\r\n    </ItemBox>\r\n\t  <ItemBox title=\"DPR曲线\">\r\n      <div v-for=\"item in curveType\" class=\"curveType\">\r\n        <div class=\"chart\">\r\n          <HChart :options=\"item.option\"></HChart>\r\n          <p v-show=\"noData\" style=\"font-size: 12px;text-align: center;color: #999;\">暂无数据</p>\r\n        </div>\r\n        <div class=\"table\">\r\n          <el-table :data=\"tableData\" height=\"350\">\r\n            <el-table-column prop=\"PaymentPeriodID\" label=\"期数\" width=\"60\"></el-table-column>\r\n            <el-table-column :prop=\"item.type\" :label=\"item.name+'(%)'\" align=center></el-table-column>\r\n            <el-table-column prop=\"AnnualCPR\" label=\"年化早偿率(%)\" align=center v-if=\"item.type == 'CPR'\"></el-table-column>\r\n            <el-table-column prop=\"AnnualCDR\" label=\"年化违约率(%)\" align=center v-if=\"item.type == 'NewDefaultRate'\"></el-table-column>\r\n            <el-table-column prop=\"CumCRR\" label=\"累计回收率(%)\" align=center v-if=\"item.type == 'CRR'\"></el-table-column>\r\n          </el-table>\r\n        </div>\r\n      </div>\r\n\t  </ItemBox>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n  import ItemBox from '@/components/layout/ItemBox';\r\n  import HChart from '@/components/common/Highcharts';\r\n  export default {\r\n    components: {HChart, ItemBox},\r\n    data() {\r\n      return {\r\n        noData:false,\r\n        option2: null,\r\n        noData2:false,\r\n        tableData:[],\r\n        tableData2:[],\r\n        curveType:[{\r\n          name:'早偿率',\r\n          type:'CPR',\r\n          option:null,\r\n        },\r\n        {\r\n          name:'违约率',\r\n          type:'NewDefaultRate',\r\n          option:null,\r\n        },{\r\n          name:'回收率',\r\n          type:'CRR',\r\n          option:null,\r\n        },{\r\n          name:'累计违约率',\r\n          type:'CDR',\r\n          option:null,\r\n        }]\r\n      }\r\n    },\r\n    computed: {\r\n\t    TrustID() {\r\n\t      return this.$store.state.productInfo.trustId;\r\n\t    }\r\n\t  },\r\n    created() {\r\n      this.getChartData()\r\n      this.getOverdueData()\r\n    },\r\n    methods:{\r\n      getOverdueData() {\r\n        var svc = this.$http(\"PortfolioManagement\", \"DV.usp_GetArrearsDistributionCurve\");\r\n        svc.AddParam({ Name: 'TrustId', Value: this.TrustID, DBType: 'int' });\r\n        svc.ExecTable().then(res => {\r\n          if (res.length>0) {\r\n            let tableData2 = JSON.parse(JSON.stringify(res))\r\n            var data = {}\r\n            let xData = []\r\n            for (var i = 0; i < res.length; i++) {\r\n              xData.push(res[i].PaymentPeriodID+'期')\r\n              for(var key in res[i]) {\r\n                if (key == 'PCT_GT30' || key == 'PCT_GT60' || key == 'PCT_GT90') {\r\n                  res[i][key] = res[i][key]?Number(res[i][key].toFixed(4)):res[i][key];\r\n                  tableData2[i][key] = tableData2[i][key] || tableData2[i][key] == 0?tableData2[i][key].toFixed(4):tableData2[i][key]\r\n                  if (i == 0) {\r\n                    data[key] = []\r\n                  }\r\n                }\r\n                tableData2[i][key] = tableData2[i][key] == null?'ND':tableData2[i][key]\r\n              }\r\n              for(var key in data) {\r\n                data[key].push(res[i][key])\r\n              }\r\n            }\r\n            let serData = [];\r\n            this.tableData2 = tableData2;\r\n            for(var key in data) {\r\n              serData.push({\r\n                name:key=='PCT_GT30'?'逾期30+':key=='PCT_GT60'?'逾期60+':key=='PCT_GT90'?'逾期90+':'',\r\n                data:data[key]\r\n              })\r\n            }\r\n            console.log(serData)\r\n            this.option2 = this.optionFun(xData,serData)\r\n          }else{\r\n            this.noData2 = true\r\n          }\r\n        })\r\n      },\r\n      getChartData() {\r\n        var svc = this.$http(\"PortfolioManagement\", \"DV.usp_PDRateByTrustId\");\r\n        svc.AddParam({ Name: 'TrustId', Value: this.TrustID, DBType: 'int' });\r\n        svc.ExecTable().then(res => {\r\n          if (res.length>0) {\r\n            let tableData = JSON.parse(JSON.stringify(res))\r\n            var data = {}\r\n            let xData = []\r\n            for (var i = 0; i < res.length; i++) {\r\n              xData.push(res[i].PaymentPeriodID+'期')\r\n              \r\n                for(var key in res[i]) {\r\n                  if (key !== 'TrustID' && key !== 'AssetType' && key !== 'PaymentPeriodID') {\r\n                    res[i][key] = res[i][key]?Number(res[i][key].toFixed(4)):res[i][key]\r\n                    tableData[i][key] = tableData[i][key] || tableData[i][key] == 0?tableData[i][key].toFixed(4):tableData[i][key]\r\n                    if (i == 0) {\r\n                      data[key] = []\r\n                    }\r\n                  }\r\n                  tableData[i][key] = tableData[i][key] == null?'ND':tableData[i][key]\r\n                }\r\n              \r\n              for(var key in data) {\r\n                data[key].push(res[i][key])\r\n              }\r\n            }\r\n            this.tableData = tableData;\r\n            for(var key in data) {\r\n              console.log(key)\r\n              let obj = {}\r\n              for (var i = 0; i < this.curveType.length; i++) {\r\n               if (this.curveType[i].type == key) {\r\n                obj.name = this.curveType[i].name\r\n                obj.data = data[key]\r\n                if (key == 'NewDefaultRate') {\r\n                  let serData = []\r\n                  serData.push(obj)\r\n                  serData.push({\r\n                    name:'年化违约率',\r\n                    data:data.AnnualCDR\r\n                  })\r\n                  this.curveType[i].option = this.optionFun(xData,serData)\r\n                }else if(this.curveType[i].type == 'CPR') {\r\n                  let serData = []\r\n                  serData.push(obj)\r\n                  serData.push({\r\n                    name:'年化早偿率',\r\n                    data:data.AnnualCPR\r\n                  })\r\n                  this.curveType[i].option = this.optionFun(xData,serData)\r\n                }else if(this.curveType[i].type == 'CRR') {\r\n                  let serData = []\r\n                  serData.push(obj)\r\n                  serData.push({\r\n                    name:'累计回收率',\r\n                    data:data.CumCRR\r\n                  })\r\n                  this.curveType[i].option = this.optionFun(xData,serData)\r\n                }else{\r\n                  this.curveType[i].option = this.optionFun(xData,[obj])\r\n                }\r\n                \r\n               } \r\n              }\r\n            }\r\n          }else{\r\n          \tthis.noData = true\r\n          }\r\n\r\n        })\r\n      },\r\n      optionFun(xData,data) {\r\n        return {\r\n          chart: {\r\n            type: 'spline'\r\n          },\r\n          title: {\r\n            text: null\r\n          },\r\n          subtitle: {\r\n            text: null\r\n          },\r\n          xAxis: {\r\n            categories: xData,\r\n            crosshair: true\r\n          },\r\n          yAxis: {\r\n            title: {\r\n              text: '',\r\n            },\r\n            labels : { \r\n              format:'{value} %'\r\n            }\r\n          },\r\n          tooltip: {\r\n            // head + 每个 point + footer 拼接成完整的 table\r\n            headerFormat: '<span style=\"font-size:10px\">{point.key}</span><table>',\r\n            pointFormat: '<tr><td style=\"color:{series.color};padding:0\">{series.name}: </td>' +\r\n            '<td style=\"padding:0\"><b>{point.y} %</b></td></tr>',\r\n            footerFormat: '</table>',\r\n            shared: true,\r\n            useHTML: true\r\n          },\r\n          plotOptions: {\r\n            column: {\r\n              borderWidth: 0\r\n            }\r\n          },\r\n          series: data\r\n        };\r\n      }\r\n    }\r\n  }\r\n</script>\r\n"],"sourceRoot":"src/views/product"}]}